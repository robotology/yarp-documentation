<!-- HTML header for doxygen 1.8.12-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>YARP: The ResourceFinder Class (basic)</title>
<link rel="shortcut icon" href="yarp-favicon.ico" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">
    var DOCUMENTATION_OPTIONS = { VERSION: '3.3.3' };
</script>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="yarp-doxygen-style.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../version_switch.js"></script>
<link rel="stylesheet" type="text/css" href="cookieconsent.min.css" />
<script src="cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#eb6c44",
      "text": "#ffffff"
    },
    "button": {
      "background": "#237afc",
    }
  },
  "theme": "classic",
  "content": {
    "message": "INFORMATION NOTICE ON COOKIES : This website uses only browsing/session cookies. Users can choose whether or not to accept the use of cookies and access the website. By clicking on \"Further information\", the full information notice on the types of cookies will be displayed and you will be able  to choose whether or not to accept them whilst browsing on the website.",
    "dismiss": "ACCEPT and close",
    "link": "Further information",
    "href": "http://www.icub.org/other/personal_data_notice.html"
  }
})});
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="yarp-robot-64.png"/></td>
  <td id="projectalign" style="padding-left: 1.5em;">
   <div id="projectname">YARP</div>
   <div id="projectbrief">Yet Another Robot Platform</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('yarp_resource_finder_basic.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">The ResourceFinder Class (basic) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#rf_basic_intro">Introduction</a></li>
<li class="level1"><a href="#rf_basic_discussion">Discussion</a></li>
<li class="level1"><a href="#rf_basic_code">Code</a></li>
</ul>
</div>
<div class="textblock"><p>This tutorial shows how to use the <a class="el" href="classyarp_1_1os_1_1ResourceFinder.html" title="Helper class for finding config files and other external resources.">yarp::os::ResourceFinder</a> class to organize parameters passed to modules.</p>
<p>The ResourceFinder is a helper class that allows to find and read configuration files from YARP's installation directories or from directories that are user specific (see <a class="el" href="yarp_data_dirs.html">YARP data directories</a>).</p>
<h1><a class="anchor" id="rf_basic_intro"></a>
Introduction</h1>
<p>Suppose we wish to write a module called 'rf_basic' that performs random movements of a single joint. The module is generic, so it can control any of the available joints of one of the limbs of a robot, either a real or a simulated one.</p>
<p>The module should receive the following parameters:</p>
<ul>
<li><code>--robot &lt;name&gt;</code> (the name of the robot) </li>
<li><code>--part &lt;robotpart&gt;</code> (the limb of the robot) </li>
<li><code>--joint &lt;jointnumber&gt;</code> (the joint we want to control)</li>
</ul>
<p>In the module <em>main</em> function we add:</p>
<div class="fragment"><div class="line">ResourceFinder rf;</div>
<div class="line">rf.configure(argc, argv);</div>
</div><!-- fragment --><p>This creates an instance of the ResourceFinder, and configures it using data from the command line. We can query the value of the parameters:</p>
<div class="fragment"><div class="line">std::string robotName=rf.find(<span class="stringliteral">&quot;robot&quot;</span>).asString();</div>
<div class="line">std::string partName=rf.find(<span class="stringliteral">&quot;part&quot;</span>).asString();</div>
<div class="line"><span class="keywordtype">int</span> joint=rf.find(<span class="stringliteral">&quot;joint&quot;</span>).asInt32();</div>
<div class="line"> </div>
<div class="line">std::cout &lt;&lt; <span class="stringliteral">&quot;Running with:\n&quot;</span>;</div>
<div class="line">std::cout &lt;&lt; <span class="stringliteral">&quot; robot: &quot;</span> &lt;&lt; robotName.c_str() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line">std::cout &lt;&lt; <span class="stringliteral">&quot; part: &quot;</span> &lt;&lt; partName.c_str() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line">std::cout &lt;&lt; <span class="stringliteral">&quot; joint: &quot;</span> &lt;&lt; joint &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
</div><!-- fragment --><p>This achieves what we want. The program <em>rf_basic</em> can parse the parameters from the command line as desired. We here assume you are in the source directory of rf_basic and that you wrote a valid CMakeLists.txt. Compile with:</p>
<div class="fragment"><div class="line">mkdir build</div>
<div class="line">cd build</div>
<div class="line">cmake ../</div>
<div class="line">make</div>
</div><!-- fragment --><p>Finally run the newly created executable:</p>
<div class="fragment"><div class="line">./rf_basic --robot robby --part head --joint 3</div>
</div><!-- fragment --><pre class="fragment">Running with:
 robot: robby
 part: head
 joint: 3
</pre><p>Now suppose we wish to place these configuration parameters in a file called <em>config.ini</em>. We can put this file together with the sources in a specific folder called <em>randomMotion</em>.</p>
<p>Create the file <code>./randomMotion/config.ini</code></p>
<p>Open it with your preferred editor and type: </p><div class="fragment"><div class="line">robot icub</div>
<div class="line">part head</div>
<div class="line">joint 0</div>
</div><!-- fragment --><p>The code above already achieves what we wanted. The ResourceFinder automatically checks for a parameter <code>--from</code> that specifies from which file to read configuration parameters:</p>
<div class="fragment"><div class="line">./rf_basic --from ../randomMotion/config.ini</div>
</div><!-- fragment --><pre class="fragment">Running with:
 robot: icub
 part: head
 joint: 0
</pre><p>Notice that we here assume you are in the <em>build</em> directory.</p>
<p>In many cases you don't want to bother about the exact path of the ini file. This happens for example if you are writing a script that executes the module and you don't know the exact configuration of the machine (it could even be running a different operating system!). This is the case for example when writing scripts for the <a class="el" href="yarpmanager.html">yarpmanager: edit, run and manage multiple programs on a set of machines</a>.</p>
<p>But first let's provide the ResourceFinder with a default configuration file so that the user does not have to specify it in the command line (notice that the parameter <em>&ndash;from</em> overwrites this setting):</p>
<div class="fragment"><div class="line">ResourceFinder rf;</div>
<div class="line">rf.setVerbose(); <span class="comment">//logs searched directories</span></div>
<div class="line">rf.setDefaultConfigFile(<span class="stringliteral">&quot;config.ini&quot;</span>); <span class="comment">//specifies a default configuration file</span></div>
<div class="line">rf.configure(argc, argv);</div>
</div><!-- fragment --><p>Now we can put <em>config.ini</em> in one of the data directories defined by YARP. A possible option is the directory .local/share/yarp/contexts inside the home of the user (in windows this is %APPDATA%/yarp/contexts, see <a class="el" href="yarp_data_dirs.html">YARP data directories</a> for more details). By default this is the first place in which the ResourceFinder searches for files if not instructed with a precise path (like in this case).</p>
<p>To avoid confusions and clashes with other similar files we keep the file inside the directory <em>randomMotion</em>; we call this directory a <em>context</em> for the module rf_basic.</p>
<div class="fragment"><div class="line">cp -r ../randomMotion/ $HOME/.local/share/yarp/contexts</div>
</div><!-- fragment --><p>Now from any working directory in the computer you can run your module and it will read parameters from $HOME/.local/share/yarp/contexts/randomMotion/config.ini and do its job.</p>
<p>To do this we can run rf_basic with the parameter <code>--context</code>:</p>
<div class="fragment"><div class="line">./rf_basic --context randomMotion</div>
</div><!-- fragment --><pre class="fragment">[...]
|| found &lt;home&gt;/.local/share/yarp/contexts/randomMotion/config.ini
Running with:
 robot: robby
 part: head
 joint: 0
</pre><p>This is useful because:</p>
<ul>
<li>the context directory can contain more than a single file, by changing only this directory we change the whole configuration of the module with a single command; </li>
<li>YARP defines a set of places that can contain context directories, in our example the <em>randomMotion</em> folder can be installed with the executable and located at runtime without the user providing its exact path (which is system dependent).</li>
</ul>
<p>In fact we can now create another directory to store a different configuration file. This file could for example configure rf_basic to connect to a simulator and move joint number 2 of the arm.</p>
<p>We create a new directory and add there a new file:</p>
<div class="fragment"><div class="line">mkdir $HOME/.local/share/yarp/contexts/randomMotionSim</div>
</div><!-- fragment --><p>Create with your preferred editor a file called <em>config.ini</em> that contains the following lines:</p>
<div class="fragment"><div class="line">robot robbySim</div>
<div class="line">part right_arm</div>
<div class="line">joint 2</div>
</div><!-- fragment --><p>Put the file in the directory <em>randomMotionSim</em> you just created.</p>
<p>We run:</p>
<div class="fragment"><div class="line">./rf_basic --context randomMotionSim</div>
</div><!-- fragment --><pre class="fragment">[...]
|| found &lt;home&gt;/.local/share/yarp/contexts/randomMotionSim/config.ini
Running with:
 robot: robbySim
 part: right_arm
 joint: 2
</pre><p>If you wish, you can specify a 'defaultContext' to be used when no parameters are given to the module.</p>
<p>Just add the following line after the call to setDefaultConfigFile():</p>
<div class="fragment"><div class="line">rf.setDefaultContext(<span class="stringliteral">&quot;randomMotion&quot;</span>);</div>
</div><!-- fragment --><p>Now running:</p>
<div class="fragment"><div class="line">./rf_basic</div>
</div><!-- fragment --><pre class="fragment">[...]
|| found &lt;home&gt;/.local/share/yarp/contexts/randomMotion/config.ini
Running with:
 robot: robby
 part: head
 joint: 0
</pre><p>Before you move to the next tutorials it is better to cleanup your $HOME directory:</p>
<div class="fragment"><div class="line">rm -rf $HOME/.local/share/yarp/contexts/randomMotion</div>
<div class="line">rm -rf $HOME/.local/share/yarp/contexts/randomMotionSim</div>
</div><!-- fragment --><h1><a class="anchor" id="rf_basic_discussion"></a>
Discussion</h1>
<p>We have seen how the ResourceFinder facilitates passing parameters to a module from a file. The ResourceFinder follows particular rules to locate configuration files that allow, for example, to switch the "initialization context" from which a module will be configured.</p>
<p>For simplicity, in the above example, we used specific Linux commands and directories. Adapting this tutorials to other operating systems should be strightforward.</p>
<p>Normally context directories are not copied manually to the home of the user, but they are installed together with other contexts in YARP's directories and managed with the yarp-config tool. The tutorial <a class="el" href="yarp_resource_finder_installation.html">How to install files for the ResourceFinder</a> describes how to use CMake to configure your build so that configuration files are automatically installed and it links to the yarp-config help page.</p>
<p>More insights on the ResourceFinder are given in a more advanced tutorial <a class="el" href="yarp_resource_finder_advanced.html">The ResourceFinder Class (advanced)</a>. See also the <a class="el" href="classyarp_1_1os_1_1ResourceFinder.html" title="Helper class for finding config files and other external resources.">yarp::os::ResourceFinder</a> class documentation.</p>
<h1><a class="anchor" id="rf_basic_code"></a>
Code</h1>
<p>See code in: example/resourceFinder/tutorial_rf_basic.cpp </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li><span id="projectname_footer">YARP</span></li>
    <li><span id="projectnumber" class="version_switch">3.3.3</span></li>
    <li class="footer">Generated on Tue Nov 3 2020 16:57:07 for YARP by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
