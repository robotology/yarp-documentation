<!-- HTML header for doxygen 1.8.12-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>YARP: mpi carriers</title>
<link rel="shortcut icon" href="yarp-favicon.ico" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">
    var DOCUMENTATION_OPTIONS = { VERSION: '3.3.3' };
</script>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="yarp-doxygen-style.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../version_switch.js"></script>
<link rel="stylesheet" type="text/css" href="cookieconsent.min.css" />
<script src="cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#eb6c44",
      "text": "#ffffff"
    },
    "button": {
      "background": "#237afc",
    }
  },
  "theme": "classic",
  "content": {
    "message": "INFORMATION NOTICE ON COOKIES : This website uses only browsing/session cookies. Users can choose whether or not to accept the use of cookies and access the website. By clicking on \"Further information\", the full information notice on the types of cookies will be displayed and you will be able  to choose whether or not to accept them whilst browsing on the website.",
    "dismiss": "ACCEPT and close",
    "link": "Further information",
    "href": "http://www.icub.org/other/personal_data_notice.html"
  }
})});
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="yarp-robot-64.png"/></td>
  <td id="projectalign" style="padding-left: 1.5em;">
   <div id="projectname">YARP</div>
   <div id="projectbrief">Yet Another Robot Platform</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('carrier_config_mpi.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">mpi carriers </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#carrier_config_mpi_usage">Using the MPI carriers</a></li>
<li class="level1"><a href="#carrier_config_mpi_intro">What is MPI?</a></li>
<li class="level1"><a href="#carrier_config_mpi_benefits">Benefits of using MPI</a></li>
<li class="level1"><a href="#carrier_config_mpi_sideeffects">Sideeffects of using MPI</a></li>
<li class="level1"><a href="#carrier_config_mpi_compliation">Compiling YARP with MPI support</a></li>
<li class="level1"><a href="#carrier_config_mpi_implementations">Open source MPI implementations</a></li>
</ul>
</div>
<div class="textblock"><p>The MPI carriers are supposed be a high-performance equivalent to YARPs standard carriers (Shared memory, TCP, Mcast) while also adding the possibility for using Infiniband (Highspeed node interconnect).</p>
<p>But they do not allow for process-local connections.</p>
<dl class="section note"><dt>Note</dt><dd>They are still work in progress and should be considered experimental. Please report any problems.</dd></dl>
<h1><a class="anchor" id="carrier_config_mpi_usage"></a>
Using the MPI carriers</h1>
<p>If you have compiled one or both mpi carriers (see <a class="el" href="carrier_config_mpi.html#carrier_config_mpi_compliation">Compiling YARP with MPI support</a>), you can connect as usual: </p><div class="fragment"><div class="line"><a class="code" href="namespaceyarp.html">yarp</a> connect /port1 /port2 mpi</div>
<div class="line"><span class="comment">// or</span></div>
<div class="line"><a class="code" href="namespaceyarp.html">yarp</a> connect /port1 /port2 bcast</div>
</div><!-- fragment --><dl class="section user"><dt>mpi</dt><dd><ul>
<li>The 'mpi' carrier is using point-to-point communication (like tcp), i.e. for every receiver there is a sender-thread which sends a copy of the data. This leads to a linear transmission time, O(n). </li>
<li>It supports replies. </li>
<li>The disconnect works as usual <div class="fragment"><div class="line"><a class="code" href="namespaceyarp.html">yarp</a> disconnect /port1 /port2</div>
</div><!-- fragment --></li>
</ul>
</dd></dl>
<dl class="section user"><dt>bcast</dt><dd><ul>
<li>The 'bcast' carrier is using collective broadcasting (similar to mcast but reliable ), i.e. the data is only send once by the sender and passed on by the receivers as needed. This leads to a decreased transmission time, roughly O(log_2(n)). </li>
<li>It does not support replies. </li>
<li>As of SVN rev. 8752, the disconnect (should) works as usual. </li>
<li>Older versions: the disconnect does not works properly: it is not possible to disconnect only one receiver. And in order to disconnect all at once you need to disconnect the connection which was created first.</li>
</ul>
</dd></dl>
<h1><a class="anchor" id="carrier_config_mpi_intro"></a>
What is MPI?</h1>
<p><b> Quote from the MPI-1 standard: </b> MPI-1 provides an interface that allows processes in a parallel program to communicate with one another. MPI-1 specifies neither how the processes are created, nor how they establish communication. Moreover, an MPI-1 application is static; that is, no processes can be added to or deleted from an application after it has been started.</p>
<p>In the specification of MPI-2 (<em><a href="http://www.mpi-forum.org/docs/mpi-20-html/node89.htm#Node89">http://www.mpi-forum.org/docs/mpi-20-html/node89.htm#Node89</a></em>), these issues were addressed with the process management model. So MPI-2 can be used as an interface for port communication in YARP, where processes need to establish a connection at runtime.</p>
<h1><a class="anchor" id="carrier_config_mpi_benefits"></a>
Benefits of using MPI</h1>
<ul>
<li>It has become a de facto standard for communication among processes that model a parallel program running on a distributed memory system </li>
<li>Is widely used and has many open-source implementations </li>
<li>Due to the tight binding between processes it allows for high-performance communication. According to some first bandwidth tests, it is more efficient than YARPs standard TCP implementation using ACE </li>
<li>Offers different channels/protocols for communication: Shared memory, Ethernet sockets, Infiniband (implementation dependent) </li>
<li>Broadcast functionality: Increased efficiency for one-sender-mulitple-receiver scenario</li>
</ul>
<h1><a class="anchor" id="carrier_config_mpi_sideeffects"></a>
Sideeffects of using MPI</h1>
<ul>
<li>MPI creates a tight binding between processes. Therefore, terminating a process without a proper 'yarp disconnect' can (or probably will) crash all other processes to which it was connected. </li>
<li>Induces a high load onto the processor due to busy polling (at least for broadcasting). This can hurt the performance in the oversubscription case (more compute-processes than cores).</li>
</ul>
<h1><a class="anchor" id="carrier_config_mpi_compliation"></a>
Compiling YARP with MPI support</h1>
<p>Enable the creation of one or both carriers in cmake: </p><div class="fragment"><div class="line">ENABLE_yarpcar_mpi_carrier          =&gt; ON</div>
<div class="line">ENABLE_yarpcar_mpibcast_carrier     =&gt; ON</div>
</div><!-- fragment --><p> If you have MPI installed in a standard location, cmake-configure should find all the relevant information. Otherwise explicitly specify the location of your mpiexec </p><div class="fragment"><div class="line">MPIEXEC   =&gt; /path/to/mpi_binaries/mpiexec</div>
</div><!-- fragment --><p> and the other cmake-variables should be deduced. BUT in this case, you probably will either need to start your program explicitly with mpi (i.e. mpiexec <em>your_program</em>) or change the $PATH variable such that your custom mpiexec will be the first one to be found!!</p>
<p>Finally, configure and recompile.</p>
<dl class="section user"><dt>Requirements</dt><dd>There are two requirements for the MPI implementation you would like to use: <ul>
<li>It needs to support the MPI-2 standard. This should be fulfilled for any recent version of the major implementations. <br  />
If not it probably will fail with some 'unknown function' error for MPI_Open_port. Haven't tested that.... </li>
<li>It needs to provide highest thread-safety support, i.e. MPI_THREAD_MULTIPLE This is maybe not available in all implementations, or at least it needs to be enabled during the compilation of the MPI library. <br  />
If not available, the connection attempt will fail with '<a class="el" href="classMpiComm.html" title="Wrapper for MPI_Comm communicator.">MpiComm</a>: MPI implementation doesn't provide required thread safety'.</li>
</ul>
</dd></dl>
<h1><a class="anchor" id="carrier_config_mpi_implementations"></a>
Open source MPI implementations</h1>
<dl class="section user"><dt>OpenMPI</dt><dd><em><a href="http://www.open-mpi.org/">http://www.open-mpi.org/</a></em> <br  />
If you use precompiled binaries (usually available for all major Linux distributions), please check availability of thread safety with <div class="fragment"><div class="line">ompi_info | grep -i thread</div>
<div class="line"><span class="preprocessor"># =&gt; Thread support: posix (mpi: yes/no)</span></div>
</div><!-- fragment --> Compiler flag: <div class="fragment"><div class="line">--enable-mpi-threads    Enable threads <span class="keywordflow">for</span> MPI applications (<span class="keywordflow">default</span>:</div>
<div class="line">                        disabled)</div>
</div><!-- fragment --></dd></dl>
<dl class="section user"><dt>MPICH2</dt><dd><em><a href="http://www.mcs.anl.gov/research/projects/mpich2/index.php">http://www.mcs.anl.gov/research/projects/mpich2/index.php</a></em> <br  />
Compiler flag: <div class="fragment"><div class="line">--enable-threads - Build MPICH2 with support <span class="keywordflow">for</span> multi-threaded</div>
<div class="line">                   applications. Only the sock and nemesis channels</div>
<div class="line">                   support MPI_THREAD_MULTIPLE.</div>
</div><!-- fragment --></dd></dl>
<dl class="section user"><dt>MVAPICH2</dt><dd><em><a href="http://mvapich.cse.ohio-state.edu/overview/mvapich2/">http://mvapich.cse.ohio-state.edu/overview/mvapich2/</a></em> <br  />
Compiler flag (use default): <div class="fragment"><div class="line">--enable-threads=level - Control the level of thread support in the</div>
<div class="line">                         MPICH <a class="code" href="RandnScalar_8cpp.html#acfd212359dc5a809fd0f4f7195c8e3f6">implementation</a>.  The following levels</div>
<div class="line">                         are supported.</div>
<div class="line">       <span class="keywordflow">default</span>         - Choose thread level at runtime based on parameters</div>
<div class="line">                         passed to MPI_Init_thread (<span class="keywordflow">default</span>)</div>
</div><!-- fragment --> But again, only the ch3:sock and ch3:nemesis channels support MPI_THREAD_MULTIPLE. <br  />
 <br  />
When running an application which should use MPI connections, you need to enable dynamic process management with an environment variable: <div class="fragment"><div class="line">export MV2_SUPPORT_DPM=1</div>
</div><!-- fragment --> </dd></dl>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div class="ttc" id="anamespaceyarp_html"><div class="ttname"><a href="namespaceyarp.html">yarp</a></div><div class="ttdoc">The main, catch-all namespace for YARP.</div><div class="ttdef"><b>Definition:</b> <a href="numeric_8h_source.html#l00047">numeric.h:47</a></div></div>
<div class="ttc" id="aRandnScalar_8cpp_html_acfd212359dc5a809fd0f4f7195c8e3f6"><div class="ttname"><a href="RandnScalar_8cpp.html#acfd212359dc5a809fd0f4f7195c8e3f6">implementation</a></div><div class="ttdeci">RandScalar * implementation(void *t)</div><div class="ttdef"><b>Definition:</b> <a href="RandnScalar_8cpp_source.html#l00020">RandnScalar.cpp:20</a></div></div>
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li><span id="projectname_footer">YARP</span></li>
    <li><span id="projectnumber" class="version_switch">3.3.3</span></li>
    <li class="footer">Generated on Tue Nov 3 2020 16:57:06 for YARP by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
