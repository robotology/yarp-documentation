<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>YARP: Add a plugin to YARP</title>
<link rel="shortcut icon" href="yarp-favicon.ico" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">
    var DOCUMENTATION_OPTIONS = { VERSION: '3.11.2' };
</script>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="yarp-doxygen-style.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../version_switch.js"></script>
<script src="https://cookiehub.net/c2/44d56061.js"></script>
<script type="text/javascript">
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('consent', 'default', {'ad_storage': 'denied', 'analytics_storage': 'denied', 'wait_for_update': 500});
document.addEventListener("DOMContentLoaded", function(event) {
var cpm = {};
window.cookiehub.load(cpm);
});
</script>
<!--
<link rel="stylesheet" type="text/css" href="cookieconsent.min.css" />
<script src="cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#eb6c44",
      "text": "#ffffff"
    },
    "button": {
      "background": "#237afc",
    }
  },
  "theme": "classic",
  "content": {
    "message": "INFORMATION NOTICE ON COOKIES : This website uses only browsing/session cookies. Users can choose whether or not to accept the use of cookies and access the website. By clicking on \"Further information\", the full information notice on the types of cookies will be displayed and you will be able  to choose whether or not to accept them whilst browsing on the website.",
    "dismiss": "ACCEPT and close",
    "link": "Further information",
    "href": "http://www.icub.eu/other/personal_data_notice.html"
  }
})});
</script>
-->
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="yarp-robot-64.png"/></td>
  <td id="projectalign" style="padding-left: 1.5em;">
   <div id="projectname">YARP</div>
   <div id="projectbrief">Yet Another Robot Platform</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__add__a__plugin.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">Add a plugin to YARP<div class="ingroups"><a class="el" href="group__dev__all.html">Devices</a> &raquo; <a class="el" href="group__dev__tutorials.html">Tutorials and Examples about Devices</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>In YARP, a "plugin" is an implementation of some service for which there are many choices and alternatives.  
</p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Collaboration diagram for Add a plugin to YARP:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__add__a__plugin.png" border="0" usemap="#agroup____add____a____plugin" alt=""/></div>
<map name="agroup____add____a____plugin" id="agroup____add____a____plugin">
<area shape="rect" title="In YARP, a &quot;plugin&quot; is an implementation of some service for which there are many choices and alterna..." alt="" coords="227,13,384,38"/>
<area shape="rect" href="group__dev__tutorials.html" title="Tutorials and Examples about Devices." alt="" coords="5,5,179,45"/>
</map>
</div>
<p>In YARP, a "plugin" is an implementation of some service for which there are many choices and alternatives. </p>
<p>There are two basic types of plugin for YARP: devices and carriers. Devices implement interfaces to cameras, controlboards, and other hardware. Carriers implement different network protocols. Users select which devices and carriers they want to have included in YARP (or they can compile them separately).</p>
<p>Optional devices and carriers are enabled or disabled via CMake options. Enabling a device or carrier may require extra libraries to be installed.</p>
<p>Before discussing how to add new devices or carriers into the YARP library itself, we look at how a user can make their own library of plugins. This is a useful first step in getting confident about how plugins work.</p>
<h1><a class="anchor" id="add_a_plugin_single"></a>
Making a single plugin</h1>
<p>Let's take the <a class="el" href="classFakeFrameGrabber.html" title="fakeFrameGrabber: A fake camera for testing.">FakeFrameGrabber</a> example device developed in <a class="el" href="group__note__devices.html">Getting Started with YARP Devices</a> and turn it into a plugin. Make a directory called "fake_grabber" (or whatever you like), and add the following as "fake_grabber/FakeFrameGrabber.h". </p><div class="fragment"><div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * SPDX-FileCopyrightText: 2006-2021 Istituto Italiano di Tecnologia (IIT)</span></div>
<div class="line"><span class="comment"> * SPDX-FileCopyrightText: 2006-2010 RobotCub Consortium</span></div>
<div class="line"><span class="comment"> * SPDX-License-Identifier: BSD-3-Clause</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="libYARP__os_2src_2yarp_2os_2all_8h.html">yarp/os/all.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="libYARP__dev_2src_2yarp_2dev_2all_8h.html">yarp/dev/all.h</a>&gt;</span></div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classFakeFrameGrabber.html">FakeFrameGrabber</a> : <span class="keyword">public</span> <a class="code hl_class" href="classyarp_1_1dev_1_1IFrameGrabberOf.html">yarp::dev::IFrameGrabberImage</a>,</div>
<div class="line">                         <span class="keyword">public</span> <a class="code hl_class" href="classyarp_1_1dev_1_1DeviceDriver.html">yarp::dev::DeviceDriver</a> {</div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    <span class="keywordtype">int</span> w, h;</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <a class="code hl_function" href="classFakeFrameGrabber.html#a8ff267cce8e2ae58c670b19a4821ad85">FakeFrameGrabber</a>() {</div>
<div class="line">        h = w = 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">bool</span> <a class="code hl_function" href="classFakeFrameGrabber.html#a9ddf08b24b0ae18c4e8e6a902d5328cb">open</a>(<span class="keywordtype">int</span> w, <span class="keywordtype">int</span> h) {</div>
<div class="line">        this-&gt;w = w;</div>
<div class="line">        this-&gt;h = h;</div>
<div class="line">        <span class="keywordflow">return</span> w&gt;0 &amp;&amp; h&gt;0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code hl_function" href="classFakeFrameGrabber.html#a9ddf08b24b0ae18c4e8e6a902d5328cb">open</a>(<a class="code hl_class" href="classyarp_1_1os_1_1Searchable.html">yarp::os::Searchable</a>&amp; config) {</div>
<div class="line">        <span class="comment">// extract width and height configuration, if present</span></div>
<div class="line">        <span class="comment">// otherwise use 128x128</span></div>
<div class="line">        <span class="keywordtype">int</span> desiredWidth = config.<a class="code hl_function" href="classyarp_1_1os_1_1Searchable.html#aa7b406215b653817f2450ac416b65867">check</a>(<span class="stringliteral">&quot;w&quot;</span>,<a class="code hl_class" href="classyarp_1_1os_1_1Value.html">yarp::os::Value</a>(128)).asInt32();</div>
<div class="line">        <span class="keywordtype">int</span> desiredHeight = config.<a class="code hl_function" href="classyarp_1_1os_1_1Searchable.html#aa7b406215b653817f2450ac416b65867">check</a>(<span class="stringliteral">&quot;h&quot;</span>,<a class="code hl_class" href="classyarp_1_1os_1_1Value.html">yarp::os::Value</a>(128)).asInt32();</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code hl_function" href="classFakeFrameGrabber.html#a9ddf08b24b0ae18c4e8e6a902d5328cb">open</a>(desiredWidth,desiredHeight);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code hl_function" href="classFakeFrameGrabber.html#aff4ecdb37f6a383fcd66c586e67cbc24">close</a>() {</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>; <span class="comment">// easy</span></div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code hl_function" href="classFakeFrameGrabber.html#ae277aa487717c7c4eed0f3151dc45fca">getImage</a>(<a class="code hl_class" href="classyarp_1_1sig_1_1ImageOf.html">yarp::sig::ImageOf&lt;yarp::sig::PixelRgb&gt;</a>&amp; image);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code hl_function" href="classFakeFrameGrabber.html#a50a1bf7ffd94c8d59c186a348530fa30">height</a>()<span class="keyword"> const </span>{</div>
<div class="line">        <span class="keywordflow">return</span> h;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code hl_function" href="classFakeFrameGrabber.html#a04553de065a77b39ec3c82ca30708ae7">width</a>()<span class="keyword"> const </span>{</div>
<div class="line">        <span class="keywordflow">return</span> w;</div>
<div class="line">    }</div>
<div class="line">};</div>
<div class="ttc" id="aclassFakeFrameGrabber_html"><div class="ttname"><a href="classFakeFrameGrabber.html">FakeFrameGrabber</a></div><div class="ttdoc">fakeFrameGrabber: A fake camera for testing.</div><div class="ttdef"><b>Definition</b> <a href="FakeFrameGrabber_8h_source.html#l00040">FakeFrameGrabber.h:55</a></div></div>
<div class="ttc" id="aclassFakeFrameGrabber_html_a04553de065a77b39ec3c82ca30708ae7"><div class="ttname"><a href="classFakeFrameGrabber.html#a04553de065a77b39ec3c82ca30708ae7">FakeFrameGrabber::width</a></div><div class="ttdeci">int width() const override</div><div class="ttdoc">Return the width of each frame.</div><div class="ttdef"><b>Definition</b> <a href="FakeFrameGrabber_8cpp_source.html#l00331">FakeFrameGrabber.cpp:331</a></div></div>
<div class="ttc" id="aclassFakeFrameGrabber_html_a50a1bf7ffd94c8d59c186a348530fa30"><div class="ttname"><a href="classFakeFrameGrabber.html#a50a1bf7ffd94c8d59c186a348530fa30">FakeFrameGrabber::height</a></div><div class="ttdeci">int height() const override</div><div class="ttdoc">Return the height of each frame.</div><div class="ttdef"><b>Definition</b> <a href="FakeFrameGrabber_8cpp_source.html#l00327">FakeFrameGrabber.cpp:327</a></div></div>
<div class="ttc" id="aclassFakeFrameGrabber_html_a8ff267cce8e2ae58c670b19a4821ad85"><div class="ttname"><a href="classFakeFrameGrabber.html#a8ff267cce8e2ae58c670b19a4821ad85">FakeFrameGrabber::FakeFrameGrabber</a></div><div class="ttdeci">FakeFrameGrabber()=default</div></div>
<div class="ttc" id="aclassFakeFrameGrabber_html_a9ddf08b24b0ae18c4e8e6a902d5328cb"><div class="ttname"><a href="classFakeFrameGrabber.html#a9ddf08b24b0ae18c4e8e6a902d5328cb">FakeFrameGrabber::open</a></div><div class="ttdeci">bool open(yarp::os::Searchable &amp;config) override</div><div class="ttdef"><b>Definition</b> <a href="FakeFrameGrabber_8cpp_source.html#l00202">FakeFrameGrabber.cpp:202</a></div></div>
<div class="ttc" id="aclassFakeFrameGrabber_html_ae277aa487717c7c4eed0f3151dc45fca"><div class="ttname"><a href="classFakeFrameGrabber.html#ae277aa487717c7c4eed0f3151dc45fca">FakeFrameGrabber::getImage</a></div><div class="ttdeci">bool getImage(yarp::sig::ImageOf&lt; yarp::sig::PixelRgb &gt; &amp;image) override</div><div class="ttdoc">Get an image from the frame grabber.</div><div class="ttdef"><b>Definition</b> <a href="FakeFrameGrabber_8cpp_source.html#l00431">FakeFrameGrabber.cpp:431</a></div></div>
<div class="ttc" id="aclassFakeFrameGrabber_html_aff4ecdb37f6a383fcd66c586e67cbc24"><div class="ttname"><a href="classFakeFrameGrabber.html#aff4ecdb37f6a383fcd66c586e67cbc24">FakeFrameGrabber::close</a></div><div class="ttdeci">bool close() override</div><div class="ttdoc">Close the DeviceDriver.</div><div class="ttdef"><b>Definition</b> <a href="FakeFrameGrabber_8cpp_source.html#l00196">FakeFrameGrabber.cpp:196</a></div></div>
<div class="ttc" id="aclassyarp_1_1dev_1_1DeviceDriver_html"><div class="ttname"><a href="classyarp_1_1dev_1_1DeviceDriver.html">yarp::dev::DeviceDriver</a></div><div class="ttdoc">Interface implemented by all device drivers.</div><div class="ttdef"><b>Definition</b> <a href="DeviceDriver_8h_source.html#l00028">DeviceDriver.h:29</a></div></div>
<div class="ttc" id="aclassyarp_1_1dev_1_1IFrameGrabberOf_html"><div class="ttname"><a href="classyarp_1_1dev_1_1IFrameGrabberOf.html">yarp::dev::IFrameGrabberOf&lt; yarp::sig::ImageOf&lt; yarp::sig::PixelRgb &gt; &gt;</a></div></div>
<div class="ttc" id="aclassyarp_1_1os_1_1Searchable_html"><div class="ttname"><a href="classyarp_1_1os_1_1Searchable.html">yarp::os::Searchable</a></div><div class="ttdoc">A base class for nested structures that can be searched.</div><div class="ttdef"><b>Definition</b> <a href="Searchable_8h_source.html#l00030">Searchable.h:31</a></div></div>
<div class="ttc" id="aclassyarp_1_1os_1_1Searchable_html_aa7b406215b653817f2450ac416b65867"><div class="ttname"><a href="classyarp_1_1os_1_1Searchable.html#aa7b406215b653817f2450ac416b65867">yarp::os::Searchable::check</a></div><div class="ttdeci">virtual bool check(const std::string &amp;key) const =0</div><div class="ttdoc">Check if there exists a property of the given name.</div></div>
<div class="ttc" id="aclassyarp_1_1os_1_1Value_html"><div class="ttname"><a href="classyarp_1_1os_1_1Value.html">yarp::os::Value</a></div><div class="ttdoc">A single value (typically within a Bottle).</div><div class="ttdef"><b>Definition</b> <a href="Value_8h_source.html#l00042">Value.h:43</a></div></div>
<div class="ttc" id="aclassyarp_1_1sig_1_1ImageOf_html"><div class="ttname"><a href="classyarp_1_1sig_1_1ImageOf.html">yarp::sig::ImageOf</a></div><div class="ttdoc">Typed image class.</div><div class="ttdef"><b>Definition</b> <a href="Image_8h_source.html#l00604">Image.h:605</a></div></div>
<div class="ttc" id="alibYARP__dev_2src_2yarp_2dev_2all_8h_html"><div class="ttname"><a href="libYARP__dev_2src_2yarp_2dev_2all_8h.html">all.h</a></div></div>
<div class="ttc" id="alibYARP__os_2src_2yarp_2os_2all_8h_html"><div class="ttname"><a href="libYARP__os_2src_2yarp_2os_2all_8h.html">all.h</a></div></div>
</div><!-- fragment --><p>And add this as "fake_grabber/FakeFrameGrabber.cpp": </p><div class="fragment"><div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * SPDX-FileCopyrightText: 2006-2021 Istituto Italiano di Tecnologia (IIT)</span></div>
<div class="line"><span class="comment"> * SPDX-FileCopyrightText: 2006-2010 RobotCub Consortium</span></div>
<div class="line"><span class="comment"> * SPDX-License-Identifier: BSD-3-Clause</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="libYARP__os_2src_2yarp_2os_2all_8h.html">yarp/os/all.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="libYARP__dev_2src_2yarp_2dev_2all_8h.html">yarp/dev/all.h</a>&gt;</span></div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classFakeFrameGrabber.html">FakeFrameGrabber</a> : <span class="keyword">public</span> <a class="code hl_class" href="classyarp_1_1dev_1_1IFrameGrabberOf.html">yarp::dev::IFrameGrabberImage</a>,</div>
<div class="line">                         <span class="keyword">public</span> <a class="code hl_class" href="classyarp_1_1dev_1_1DeviceDriver.html">yarp::dev::DeviceDriver</a> {</div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    <span class="keywordtype">int</span> w, h;</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <a class="code hl_function" href="classFakeFrameGrabber.html#a8ff267cce8e2ae58c670b19a4821ad85">FakeFrameGrabber</a>() {</div>
<div class="line">        h = w = 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">bool</span> <a class="code hl_function" href="classFakeFrameGrabber.html#a9ddf08b24b0ae18c4e8e6a902d5328cb">open</a>(<span class="keywordtype">int</span> w, <span class="keywordtype">int</span> h) {</div>
<div class="line">        this-&gt;w = w;</div>
<div class="line">        this-&gt;h = h;</div>
<div class="line">        <span class="keywordflow">return</span> w&gt;0 &amp;&amp; h&gt;0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code hl_function" href="classFakeFrameGrabber.html#a9ddf08b24b0ae18c4e8e6a902d5328cb">open</a>(<a class="code hl_class" href="classyarp_1_1os_1_1Searchable.html">yarp::os::Searchable</a>&amp; config) {</div>
<div class="line">        <span class="comment">// extract width and height configuration, if present</span></div>
<div class="line">        <span class="comment">// otherwise use 128x128</span></div>
<div class="line">        <span class="keywordtype">int</span> desiredWidth = config.<a class="code hl_function" href="classyarp_1_1os_1_1Searchable.html#aa7b406215b653817f2450ac416b65867">check</a>(<span class="stringliteral">&quot;w&quot;</span>,<a class="code hl_class" href="classyarp_1_1os_1_1Value.html">yarp::os::Value</a>(128)).asInt32();</div>
<div class="line">        <span class="keywordtype">int</span> desiredHeight = config.<a class="code hl_function" href="classyarp_1_1os_1_1Searchable.html#aa7b406215b653817f2450ac416b65867">check</a>(<span class="stringliteral">&quot;h&quot;</span>,<a class="code hl_class" href="classyarp_1_1os_1_1Value.html">yarp::os::Value</a>(128)).asInt32();</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code hl_function" href="classFakeFrameGrabber.html#a9ddf08b24b0ae18c4e8e6a902d5328cb">open</a>(desiredWidth,desiredHeight);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code hl_function" href="classFakeFrameGrabber.html#aff4ecdb37f6a383fcd66c586e67cbc24">close</a>() {</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>; <span class="comment">// easy</span></div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code hl_function" href="classFakeFrameGrabber.html#ae277aa487717c7c4eed0f3151dc45fca">getImage</a>(<a class="code hl_class" href="classyarp_1_1sig_1_1ImageOf.html">yarp::sig::ImageOf&lt;yarp::sig::PixelRgb&gt;</a>&amp; image);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code hl_function" href="classFakeFrameGrabber.html#a50a1bf7ffd94c8d59c186a348530fa30">height</a>()<span class="keyword"> const </span>{</div>
<div class="line">        <span class="keywordflow">return</span> h;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code hl_function" href="classFakeFrameGrabber.html#a04553de065a77b39ec3c82ca30708ae7">width</a>()<span class="keyword"> const </span>{</div>
<div class="line">        <span class="keywordflow">return</span> w;</div>
<div class="line">    }</div>
<div class="line">};</div>
</div><!-- fragment --><p>Here's a quick test program for the device, call it "fake_grabber/test_fake_grabber.cpp": </p><div class="fragment"><div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * SPDX-FileCopyrightText: 2006-2021 Istituto Italiano di Tecnologia (IIT)</span></div>
<div class="line"><span class="comment"> * SPDX-FileCopyrightText: 2006-2010 RobotCub Consortium</span></div>
<div class="line"><span class="comment"> * SPDX-License-Identifier: BSD-3-Clause</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="FakeFrameGrabber_8h.html">FakeFrameGrabber.h</a>&quot;</span></div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespaceyarp_1_1os.html">yarp::os</a>;</div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespaceyarp_1_1sig.html">yarp::sig</a>;</div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespaceyarp_1_1dev.html">yarp::dev</a>;</div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_class" href="classyarp_1_1os_1_1BufferedPort.html">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]) {</div>
<div class="line">  <a class="code hl_class" href="classyarp_1_1dev_1_1DriverCreator.html">DriverCreator</a> *<a class="code hl_class" href="classyarp_1_1os_1_1BufferedPort.html">fake_factory</a> =</div>
<div class="line">    <span class="keyword">new</span> <a class="code hl_class" href="classyarp_1_1dev_1_1DriverCreatorOf.html">DriverCreatorOf&lt;FakeFrameGrabber&gt;</a>(<span class="stringliteral">&quot;fake_grabber&quot;</span>,<span class="stringliteral">&quot;grabber&quot;</span>,<span class="stringliteral">&quot;FakeFrameGrabber&quot;</span>);</div>
<div class="line">  Drivers::factory().add(<a class="code hl_class" href="classyarp_1_1os_1_1BufferedPort.html">fake_factory</a>); <span class="comment">// hand factory over to YARP</span></div>
<div class="line"> </div>
<div class="line">  <a class="code hl_class" href="classyarp_1_1dev_1_1PolyDriver.html">PolyDriver</a> dd(<span class="stringliteral">&quot;fake_grabber&quot;</span>);</div>
<div class="line">  <span class="keywordflow">if</span> (!dd.isValid()) {</div>
<div class="line">    <a class="code hl_class" href="classyarp_1_1os_1_1BufferedPort.html">printf</a>(<span class="stringliteral">&quot;fake_grabber not available\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line">  }</div>
<div class="line">  <a class="code hl_class" href="classyarp_1_1dev_1_1IFrameGrabberOf.html">IFrameGrabberImage</a> *<a class="code hl_class" href="classyarp_1_1os_1_1BufferedPort.html">grabber</a>;</div>
<div class="line">  dd.view(<a class="code hl_class" href="classyarp_1_1os_1_1BufferedPort.html">grabber</a>);</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_class" href="classyarp_1_1os_1_1BufferedPort.html">grabber</a>==<a class="code hl_class" href="classyarp_1_1os_1_1BufferedPort.html">NULL</a>) {</div>
<div class="line">    <a class="code hl_class" href="classyarp_1_1os_1_1BufferedPort.html">printf</a>(<span class="stringliteral">&quot;*** Device failed to supply images\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line">  }</div>
<div class="line">  <a class="code hl_class" href="classyarp_1_1os_1_1BufferedPort.html">printf</a>(<span class="stringliteral">&quot;*** Device can supply images\n&quot;</span>);</div>
<div class="line">  <a class="code hl_class" href="classyarp_1_1os_1_1BufferedPort.html">ImageOf&lt;PixelRgb&gt;</a> img;</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_class" href="classyarp_1_1os_1_1BufferedPort.html">grabber</a>-&gt;getImage(img)) {</div>
<div class="line">    <a class="code hl_class" href="classyarp_1_1os_1_1BufferedPort.html">printf</a>(<span class="stringliteral">&quot;*** Got a %dx%d image\n&quot;</span>, img.<a class="code hl_function" href="classyarp_1_1sig_1_1Image.html#a27a6819365e6aaae8c89e401ca9f5475">width</a>(), img.<a class="code hl_function" href="classyarp_1_1sig_1_1Image.html#ac5ceeddf1a947a79fae87c089f33745f">height</a>());</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    <a class="code hl_class" href="classyarp_1_1os_1_1BufferedPort.html">printf</a>(<span class="stringliteral">&quot;Failed to read an image\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="aFakeFrameGrabber_8h_html"><div class="ttname"><a href="FakeFrameGrabber_8h.html">FakeFrameGrabber.h</a></div></div>
<div class="ttc" id="aclassyarp_1_1dev_1_1DriverCreatorOf_html"><div class="ttname"><a href="classyarp_1_1dev_1_1DriverCreatorOf.html">yarp::dev::DriverCreatorOf</a></div><div class="ttdoc">A factory for creating driver objects of a particular type.</div><div class="ttdef"><b>Definition</b> <a href="Drivers_8h_source.html#l00081">Drivers.h:81</a></div></div>
<div class="ttc" id="aclassyarp_1_1dev_1_1DriverCreator_html"><div class="ttname"><a href="classyarp_1_1dev_1_1DriverCreator.html">yarp::dev::DriverCreator</a></div><div class="ttdoc">A base class for factories that create driver objects.</div><div class="ttdef"><b>Definition</b> <a href="Drivers_8h_source.html#l00027">Drivers.h:27</a></div></div>
<div class="ttc" id="aclassyarp_1_1dev_1_1PolyDriver_html"><div class="ttname"><a href="classyarp_1_1dev_1_1PolyDriver.html">yarp::dev::PolyDriver</a></div><div class="ttdoc">A container for a device driver.</div><div class="ttdef"><b>Definition</b> <a href="PolyDriver_8h_source.html#l00021">PolyDriver.h:23</a></div></div>
<div class="ttc" id="aclassyarp_1_1os_1_1BufferedPort_html"><div class="ttname"><a href="classyarp_1_1os_1_1BufferedPort.html">yarp::os::BufferedPort</a></div><div class="ttdoc">A mini-server for performing network communication in the background.</div><div class="ttdef"><b>Definition</b> <a href="BufferedPort_8h_source.html#l00059">BufferedPort.h:60</a></div></div>
<div class="ttc" id="aclassyarp_1_1sig_1_1Image_html_a27a6819365e6aaae8c89e401ca9f5475"><div class="ttname"><a href="classyarp_1_1sig_1_1Image.html#a27a6819365e6aaae8c89e401ca9f5475">yarp::sig::Image::width</a></div><div class="ttdeci">size_t width() const</div><div class="ttdoc">Gets width of image in pixels.</div><div class="ttdef"><b>Definition</b> <a href="Image_8h_source.html#l00171">Image.h:171</a></div></div>
<div class="ttc" id="aclassyarp_1_1sig_1_1Image_html_ac5ceeddf1a947a79fae87c089f33745f"><div class="ttname"><a href="classyarp_1_1sig_1_1Image.html#ac5ceeddf1a947a79fae87c089f33745f">yarp::sig::Image::height</a></div><div class="ttdeci">size_t height() const</div><div class="ttdoc">Gets height of image in pixels.</div><div class="ttdef"><b>Definition</b> <a href="Image_8h_source.html#l00177">Image.h:177</a></div></div>
<div class="ttc" id="anamespaceyarp_1_1dev_html"><div class="ttname"><a href="namespaceyarp_1_1dev.html">yarp::dev</a></div><div class="ttdoc">For streams capable of holding different kinds of content, check what they actually have.</div><div class="ttdef"><b>Definition</b> <a href="jointData_8cpp_source.html#l00013">jointData.cpp:13</a></div></div>
<div class="ttc" id="anamespaceyarp_1_1os_html"><div class="ttname"><a href="namespaceyarp_1_1os.html">yarp::os</a></div><div class="ttdoc">An interface to the operating system, including Port based communication.</div><div class="ttdef"><b>Definition</b> <a href="AbstractCarrier_8h_source.html#l00013">AbstractCarrier.h:13</a></div></div>
<div class="ttc" id="anamespaceyarp_1_1sig_html"><div class="ttname"><a href="namespaceyarp_1_1sig.html">yarp::sig</a></div><div class="ttdef"><b>Definition</b> <a href="audioBufferSizeData_8cpp_source.html#l00013">audioBufferSizeData.cpp:13</a></div></div>
</div><!-- fragment --><p>YARP plugins need a CMakeLists.txt that says how to build them. The CMakeLists.txt is written in the following style (this would be "fake_grabber/CMakeLists.txt"): </p><div class="fragment"><div class="line"><span class="preprocessor"># SPDX-FileCopyrightText: 2006-2021 Istituto Italiano di Tecnologia (IIT)</span></div>
<div class="line"><span class="preprocessor"># SPDX-FileCopyrightText: 2006-2010 RobotCub Consortium</span></div>
<div class="line"><span class="preprocessor"># SPDX-License-Identifier: BSD-3-Clause</span></div>
<div class="line"> </div>
<div class="line">cmake_minimum_required(VERSION 3.19)</div>
<div class="line">find_package(YARP COMPONENTS os dev REQUIRED)</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor"># Declare a device called &quot;fake_grabber&quot;, with C++ type</span></div>
<div class="line"><span class="preprocessor"># &quot;FakeFrameGrabber&quot; defined in FakeFrameGrabber.h.  This code sets</span></div>
<div class="line"><span class="preprocessor"># up a CMake option for selecting the device, and prepares</span></div>
<div class="line"><span class="preprocessor"># some initialization boilerplate code if needed.</span></div>
<div class="line"><span class="preprocessor"># If the device is not selected, &quot;SKIP_foo&quot; will be defined.</span></div>
<div class="line">yarp_prepare_plugin(fake_grabber</div>
<div class="line">  CATEGORY device</div>
<div class="line">  TYPE <a class="code hl_class" href="classFakeFrameGrabber.html">FakeFrameGrabber</a></div>
<div class="line">  INCLUDE <a class="code hl_class" href="classFakeFrameGrabber.html">FakeFrameGrabber</a>.h</div>
<div class="line">  EXTRA_CONFIG WRAPPER=frameGrabber_nws_yarp</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span>(NOT SKIP_fake_grabber)</div>
<div class="line">  yarp_add_plugin(fake_grabber)</div>
<div class="line"> </div>
<div class="line">  target_sources(fake_grabber</div>
<div class="line">    PRIVATE</div>
<div class="line">      <a class="code hl_class" href="classFakeFrameGrabber.html">FakeFrameGrabber</a>.cpp</div>
<div class="line">      <a class="code hl_class" href="classFakeFrameGrabber.html">FakeFrameGrabber</a>.h</div>
<div class="line">  )</div>
<div class="line">  target_link_libraries(fake_grabber</div>
<div class="line">    PRIVATE</div>
<div class="line">      ${YARP_LIBRARIES}</div>
<div class="line">  )</div>
<div class="line"> </div>
<div class="line">  option(COMPILE_TEST <span class="stringliteral">&quot;Compile fake grabber test&quot;</span>)</div>
<div class="line">  <span class="keywordflow">if</span>(COMPILE_TEST)</div>
<div class="line">    add_executable(test_fake_grabber)</div>
<div class="line">    target_sources(test_fake_grabber</div>
<div class="line">      PRIVATE</div>
<div class="line">        test_fake_grabber.cpp</div>
<div class="line">        <a class="code hl_class" href="classFakeFrameGrabber.html">FakeFrameGrabber</a>.cpp</div>
<div class="line">        <a class="code hl_class" href="classFakeFrameGrabber.html">FakeFrameGrabber</a>.h</div>
<div class="line">    )</div>
<div class="line">    target_link_libraries(test_fake_grabber PRIVATE ${YARP_LIBRARIES})</div>
<div class="line">  endif()</div>
<div class="line">endif()</div>
</div><!-- fragment --><p>This style is used so that individual plugin directories can be compiled standalone for testing purposes, but will also work when bundled into a larger library. If we configure and compile this directory, we get a test program that we can run straight away. If it works, then we could immediately plug this device into YARP.</p>
<h1><a class="anchor" id="add_a_plugin_userlib"></a>
Making a plugin library</h1>
<p>Here we put together a library of YARP plugins from scratch.</p>
<p>First, let's start with a stub test program, "userlib/test_userlib.cpp": </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]) {</div>
<div class="line">  printf(<span class="stringliteral">&quot;Test program stub\n&quot;</span>);</div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p>Here's a CMakeLists.txt ("userlib/CMakeLists.txt") to compile this:</p>
<pre class="fragment">cmake_minimum_required(VERSION 3.16)
find_package(YARP COMPONENTS os REQUIRED)
add_executable(test_userlib)
target_sources(test_userlib PRIVATE test_userlib.cpp)
target_link_libraries(test_userlib PRIVATE YARP::YARP_os
                                           YARP::YARP_init)
</pre><p>Now, let's prepare a plugin library. We need to include YarpPlugin in order to get some helper functions for this. We'll just have one plugin for now, the fake_grabber device. Here's the modified "userlib/CMakeLists.txt" file: </p><div class="fragment"><div class="line"><span class="preprocessor"># SPDX-FileCopyrightText: 2006-2021 Istituto Italiano di Tecnologia (IIT)</span></div>
<div class="line"><span class="preprocessor"># SPDX-FileCopyrightText: 2006-2010 RobotCub Consortium</span></div>
<div class="line"><span class="preprocessor"># SPDX-License-Identifier: BSD-3-Clause</span></div>
<div class="line"> </div>
<div class="line">cmake_minimum_required(VERSION 3.19)</div>
<div class="line"> </div>
<div class="line">find_package(YARP COMPONENTS os dev REQUIRED)</div>
<div class="line"> </div>
<div class="line">yarp_begin_plugin_library(userlib)</div>
<div class="line">add_subdirectory(fake_grabber)</div>
<div class="line">yarp_end_plugin_library(userlib)</div>
<div class="line"> </div>
<div class="line">add_executable(test_userlib)</div>
<div class="line">target_sources(test_userlib PRIVATE test_userlib.cpp)</div>
<div class="line"> </div>
<div class="line">target_link_libraries(test_userlib PRIVATE ${YARP_LIBRARIES})</div>
<div class="line">target_link_libraries(test_userlib PRIVATE userlib)</div>
</div><!-- fragment --><p>This assumes that we have moved "fake_grabber" into the "userlib" directory.</p>
<p>Now, let's update our test program, "userlib/test_userlib.cpp": </p><div class="fragment"><div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * SPDX-FileCopyrightText: 2006-2021 Istituto Italiano di Tecnologia (IIT)</span></div>
<div class="line"><span class="comment"> * SPDX-FileCopyrightText: 2006-2010 RobotCub Consortium</span></div>
<div class="line"><span class="comment"> * SPDX-License-Identifier: BSD-3-Clause</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="libYARP__os_2src_2yarp_2os_2all_8h.html">yarp/os/all.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="libYARP__dev_2src_2yarp_2dev_2all_8h.html">yarp/dev/all.h</a>&gt;</span></div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespaceyarp_1_1os.html">yarp::os</a>;</div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespaceyarp_1_1dev.html">yarp::dev</a>;</div>
<div class="line"><a class="code hl_define" href="Network_8h.html#a00c0379968f409c34534cae763ff4797">YARP_DECLARE_PLUGINS</a>(<a class="code hl_class" href="classyarp_1_1os_1_1BufferedPort.html">userlib</a>);</div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_class" href="classyarp_1_1os_1_1BufferedPort.html">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]) {</div>
<div class="line">  <a class="code hl_class" href="classyarp_1_1os_1_1Network.html">Network</a> <a class="code hl_namespace" href="namespaceyarp.html">yarp</a>;</div>
<div class="line">  <a class="code hl_define" href="Network_8h.html#acdde34ffb3d49ed6a6d16a1636b4a54e">YARP_REGISTER_PLUGINS</a>(<a class="code hl_class" href="classyarp_1_1os_1_1BufferedPort.html">userlib</a>);</div>
<div class="line">  <a class="code hl_class" href="classyarp_1_1dev_1_1PolyDriver.html">PolyDriver</a> dd(<span class="stringliteral">&quot;fake_grabber&quot;</span>);</div>
<div class="line">  <span class="keywordflow">if</span> (!dd.isValid()) {</div>
<div class="line">    <a class="code hl_class" href="classyarp_1_1os_1_1BufferedPort.html">printf</a>(<span class="stringliteral">&quot;fake_grabber not available\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line">  }</div>
<div class="line">  <a class="code hl_class" href="classyarp_1_1os_1_1BufferedPort.html">printf</a>(<span class="stringliteral">&quot;Was able to instantiate a fake_grabber\n&quot;</span>);</div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="aNetwork_8h_html_a00c0379968f409c34534cae763ff4797"><div class="ttname"><a href="Network_8h.html#a00c0379968f409c34534cae763ff4797">YARP_DECLARE_PLUGINS</a></div><div class="ttdeci">#define YARP_DECLARE_PLUGINS(name)</div><div class="ttdef"><b>Definition</b> <a href="Network_8h_source.html#l00026">Network.h:26</a></div></div>
<div class="ttc" id="aNetwork_8h_html_acdde34ffb3d49ed6a6d16a1636b4a54e"><div class="ttname"><a href="Network_8h.html#acdde34ffb3d49ed6a6d16a1636b4a54e">YARP_REGISTER_PLUGINS</a></div><div class="ttdeci">#define YARP_REGISTER_PLUGINS(name)</div><div class="ttdef"><b>Definition</b> <a href="Network_8h_source.html#l00027">Network.h:27</a></div></div>
<div class="ttc" id="aclassyarp_1_1os_1_1Network_html"><div class="ttname"><a href="classyarp_1_1os_1_1Network.html">yarp::os::Network</a></div><div class="ttdoc">Utilities for manipulating the YARP network, including initialization and shutdown.</div><div class="ttdef"><b>Definition</b> <a href="Network_8h_source.html#l00705">Network.h:706</a></div></div>
<div class="ttc" id="anamespaceyarp_html"><div class="ttname"><a href="namespaceyarp.html">yarp</a></div><div class="ttdoc">The main, catch-all namespace for YARP.</div><div class="ttdef"><b>Definition</b> <a href="dirs_8h_source.html#l00016">dirs.h:16</a></div></div>
</div><!-- fragment --><p>We can now use cmake to configure and build, either in the "userlib" directory, or in the "userlib/fake_grabber" directory. These files are available in the YARP source package, under the directory "example/plugins".</p>
<h1><a class="anchor" id="add_a_plugin_in_yarp"></a>
Adding a plugin into YARP</h1>
<p>In directory ${YARP_ROOT}/src/devices/CMakeLists.txt, there is a list of device directories. We could just add another line to insert fake_grabber. There is no requirement that the fake_grabber subdirectory be in any particular location. Similarly, carriers can be added in $YARP_ROOT/src/carriers/CMakeLists.txt. </p>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li><span id="projectname_footer">YARP</span></li>
    <li><span id="projectnumber" class="version_switch">3.11.2</span></li>
    <li class="footer">Generated on Sat Mar 1 2025 02:35:37 for YARP by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
