<!-- HTML header for doxygen 1.8.12-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>YARP: yarpdatadumper: the YARP data recorder</title>
<link rel="shortcut icon" href="yarp-favicon.ico" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">
    var DOCUMENTATION_OPTIONS = { VERSION: '3.4.6' };
</script>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="yarp-doxygen-style.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../version_switch.js"></script>
<link rel="stylesheet" type="text/css" href="cookieconsent.min.css" />
<script src="cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#eb6c44",
      "text": "#ffffff"
    },
    "button": {
      "background": "#237afc",
    }
  },
  "theme": "classic",
  "content": {
    "message": "INFORMATION NOTICE ON COOKIES : This website uses only browsing/session cookies. Users can choose whether or not to accept the use of cookies and access the website. By clicking on \"Further information\", the full information notice on the types of cookies will be displayed and you will be able  to choose whether or not to accept them whilst browsing on the website.",
    "dismiss": "ACCEPT and close",
    "link": "Further information",
    "href": "http://www.icub.org/other/personal_data_notice.html"
  }
})});
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="yarp-robot-64.png"/></td>
  <td id="projectalign" style="padding-left: 1.5em;">
   <div id="projectname">YARP</div>
   <div id="projectbrief">Yet Another Robot Platform</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('yarpdatadumper.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">yarpdatadumper: the YARP data recorder </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#yarpdatadumper_intro">Description</a></li>
<li class="level1"><a href="#yarpdatadumper_lib">Libraries</a></li>
<li class="level1"><a href="#yarpdatadumper_codec_installation">Codec Installation</a></li>
<li class="level1"><a href="#yarpdatadumper_parameters">Parameters</a></li>
<li class="level1"><a href="#yarpdatadumper_portsa">Ports Accessed</a></li>
<li class="level1"><a href="#yarpdatadumper_portsc">Ports Created</a></li>
<li class="level1"><a href="#yarpdatadumper_in_files">Input Data Files</a></li>
<li class="level1"><a href="#yarpdatadumper_out_data">Output Data Files</a></li>
<li class="level1"><a href="#yarpdatadumper_conf_file">Configuration Files</a></li>
<li class="level1"><a href="#yarpdatadumper_example">Example</a></li>
</ul>
</div>
<div class="textblock"><p>Acquires and stores Bottles or Images and Videos from a YARP port.</p>
<h1><a class="anchor" id="yarpdatadumper_intro"></a>
Description</h1>
<p>When launched, the service monitors the presence of incoming data (bottles or images) and stores it within a folder called with the same name as the service port (or with a proper suffix appended if other data is present in the current path). In this folder the file 'data.log' contains the information (taken from the envelope field of the port) line by line as follows:</p>
<div class="fragment"><div class="line">[pck id] [time stamp] [bottle content (or image_file_name)]</div>
<div class="line">   0       1.234         0 1 2 3 ...</div>
<div class="line">   1       1.235         4 5 6 7 ...</div>
<div class="line">   ...     ...           ...</div>
</div><!-- fragment --><p>Note that if the envelope is not valid, then the Time Stamp is the reference time of the machine where the service is running. Anyway, a selection between these two Time Stamps is available for the user through &ndash;rxTime option.</p>
<p>Moreover, a file called 'info.log' is produced containing information about the data type stored within the 'data.log' file as well as the logged time stamps and the name of the yarp ports connected or disconnected to the dumper, as in the following:</p>
<div class="fragment"><div class="line">Type: [Bottle; | <a class="code" href="namespacesensor__msgs.html#ae9a51b56b8056a2874fc1d51224caa61">Image</a>; | <a class="code" href="namespacesensor__msgs.html#ae9a51b56b8056a2874fc1d51224caa61">Image</a>; Video:ext(huffyuv);]</div>
<div class="line">Stamp: [rx; | tx; | tx+rx;]</div>
<div class="line">[<a class="code" href="namespaceyarp_1_1manager.html#af8e1bb9e0c85f2c826fd01217934d145af5ddaf0ca7929578b408c909429f68f2">local</a>-timestamp] /<a class="code" href="namespaceyarp.html">yarp</a>-port-name [connected]</div>
<div class="line">[<a class="code" href="namespaceyarp_1_1manager.html#af8e1bb9e0c85f2c826fd01217934d145af5ddaf0ca7929578b408c909429f68f2">local</a>-timestamp] /<a class="code" href="namespaceyarp.html">yarp</a>-port-name [disconnected]</div>
<div class="ttc" id="anamespacesensor__msgs_html_ae9a51b56b8056a2874fc1d51224caa61"><div class="ttname"><a href="namespacesensor__msgs.html#ae9a51b56b8056a2874fc1d51224caa61">sensor_msgs::Image</a></div><div class="ttdeci">yarp::rosmsg::sensor_msgs::Image Image</div><div class="ttdef"><b>Definition:</b> <a href="libYARP__rosmsg_2src_2idl__generated__code_2yarp_2rosmsg_2sensor__msgs_2Image_8h_source.html#l00024">Image.h:24</a></div></div>
<div class="ttc" id="anamespaceyarp_1_1manager_html_af8e1bb9e0c85f2c826fd01217934d145af5ddaf0ca7929578b408c909429f68f2"><div class="ttname"><a href="namespaceyarp_1_1manager.html#af8e1bb9e0c85f2c826fd01217934d145af5ddaf0ca7929578b408c909429f68f2">yarp::manager::BrokerType::local</a></div><div class="ttdeci">@ local</div></div>
<div class="ttc" id="anamespaceyarp_html"><div class="ttname"><a href="namespaceyarp.html">yarp</a></div><div class="ttdoc">The main, catch-all namespace for YARP.</div><div class="ttdef"><b>Definition:</b> <a href="environment_8h_source.html#l00018">environment.h:18</a></div></div>
</div><!-- fragment --><p>Finally, a further file called 'timecodes.log' is also generated together with the video, which contains the timecode associated to each frame given in millisecond precision. The file content looks like the following:</p>
<div class="fragment"><div class="line"><span class="preprocessor"># timecode format v2</span></div>
<div class="line">0</div>
<div class="line">40</div>
<div class="line">80</div>
</div><!-- fragment --><p>This is useful to recover the exact timing while post-processing the video relying for example on the <code>mkvmerge</code> tool: </p><div class="fragment"><div class="line">mkvmerge -o out.mkv --timecodes 0:timecodes.log video.mkv</div>
</div><!-- fragment --><p> To get <em>mkvmerge</em> do: sudo apt-get install mkvtoolnix</p>
<p>The module <a class="el" href="yarpdataplayer.html">yarpdataplayer: replay recorded data</a> can be used to re-play a dump generated by the <a class="el" href="yarpdatadumper.html">yarpdatadumper: the YARP data recorder</a>.</p>
<h1><a class="anchor" id="yarpdatadumper_lib"></a>
Libraries</h1>
<ul>
<li>To record videos: OpenCV 2.4 and the <a href="http://wiki.team-mediaportal.com/9_Glossary/Huffyuv">huffyuv</a> codec for lossless data compression.</li>
</ul>
<h1><a class="anchor" id="yarpdatadumper_codec_installation"></a>
Codec Installation</h1>
<ul>
<li>Windows: fetch the dll library from the codec website and simply install it.</li>
<li>Linux: ffmpeg must be properly installed and recognized by OpenCV. The command "sudo apt-get ffmpeg" seemed not to work. This is a possible alternative procedure:<ol type="1">
<li>sudo apt-get install libjpeg62-dev libtiff4-dev libjasper-dev libopenexr-dev libeigen2-dev yasm libfaac-dev libopencore-amrnb-dev libopencore-amrwb-dev libtheora-dev libvorbis-dev libxvidcore-dev</li>
<li>svn checkout svn://svn.ffmpeg.org/ffmpeg/trunk ffmpeg</li>
<li>./configure &ndash;enable-gpl &ndash;enable-version3 &ndash;enable-nonfree &ndash;enable-postproc &ndash;enable-libfaac &ndash;enable-libopencore-amrnb &ndash;enable-libopencore-amrwb &ndash;enable-libtheora &ndash;enable-libvorbis &ndash;enable-libxvid &ndash;enable-x11grab &ndash;enable-swscale &ndash;enable-shared</li>
<li>sudo make install</li>
<li>recompile OpenCV through cmake</li>
</ol>
</li>
</ul>
<h1><a class="anchor" id="yarpdatadumper_parameters"></a>
Parameters</h1>
<p><code>--name portname</code></p><ul>
<li>The parameter <code>portname</code> identifies the name of the listening port open by the service; if not specified <code>/dump</code> is assumed. The leading forward slash will be added if not provided.</li>
</ul>
<p><code>--connect portname</code></p><ul>
<li>The parameter <code>portname</code> specifies the name of the port to connect the dumper to at launch time (<em>tcp</em> is used).</li>
</ul>
<p><code>--dir dirname</code></p><ul>
<li>The parameter <code>dirname</code> serves to specify the storage directory explicitly (relative to the location where the module has been launched from).</li>
</ul>
<p><code>--overwrite</code></p><ul>
<li>If this option is specified, then a pre-existing storage directory will be overwritten.</li>
</ul>
<p><code>--type datatype</code></p><ul>
<li>The parameter <code>datatype</code> selects the type of items to be stored. It can be <em>bottle</em>, <em>image</em>, <em>image_jpg</em>, <em>image_png</em> or <em>video</em>; if not specified <em>bottle</em> is assumed. Note that images are stored using the corresponding file formats. The data type <em>video</em> is available if OpenCV is found and the codec <em>huffyuv</em> is installed.</li>
</ul>
<p><code>--addVideo</code></p><ul>
<li>In case images are acquired with this option enabled, a video called 'video.ext' is also produced at the same time. The extension <code>ext</code> is determined by the option <code>videoType</code>. This option is available if OpenCV is found and the codec <em>huffyuv</em> is installed in the system.</li>
</ul>
<p><code>--videoType ext</code></p><ul>
<li>If it is required to generate a video, the parameter <code>ext</code> specifies the type of the video container employed. Available types are: <em>mkv</em> (default), <em>avi</em>.</li>
</ul>
<p><code>--downsample n</code></p><ul>
<li>With this option it is possible to reduce the storing rate by a factor <code>n</code>, i.e. the parameter <code>n</code> specifies how many items (bottles or images) shall be skipped after one acquisition.</li>
</ul>
<p><code>--rxTime</code></p><ul>
<li>With this option it is possible to select which Time Stamp to assign to the dumped data: normally the sender time is the reference, but if this option is enabled, the time of the receiving machine on which the service is running will be the reference. However, even if <code>--rxTime</code> is not selected, the receiver time will be taken as reference in case of invalid message envelope.</li>
</ul>
<p><code>--txTime</code></p><ul>
<li>Regardless of its availability, the sender time stamp will be inserted in the log straightaway. Moreover, if <code>txTime</code> is given in conjunction with the <code>rxTime</code> option (or even if <code>rxTime</code> is not selected but the sender stamp is invalid), then the following format will be adopted for the logged data:</li>
</ul>
<div class="fragment"><div class="line">[pck id] [tx stamp] [rx stamp] [message content]</div>
</div><!-- fragment --><h1><a class="anchor" id="yarpdatadumper_portsa"></a>
Ports Accessed</h1>
<p>The port the service is listening to.</p>
<h1><a class="anchor" id="yarpdatadumper_portsc"></a>
Ports Created</h1>
<ul>
<li><code>&lt;portname&gt;</code> (e.g. /dump)</li>
<li><code>&lt;portname&gt;/rpc</code> which is a remote procedure call port useful to shut down the service remotely by sending to this port the 'quit' command.</li>
</ul>
<h1><a class="anchor" id="yarpdatadumper_in_files"></a>
Input Data Files</h1>
<p>None.</p>
<h1><a class="anchor" id="yarpdatadumper_out_data"></a>
Output Data Files</h1>
<p>Within the directory <code>./&lt;portname&gt;</code> the file <code>data.log</code> is created containing the acquisitions. Besides, if <em>image</em> type has been selected, all the acquired images are also stored. A further file called <code>info.log</code> is also produced containing meta-data relevant for the logging.</p>
<p>Note that in case an acquisition with the same <code>&lt;portname&gt;</code> was previously carried out, an increasing suffix will be appended to the name of the directory.</p>
<h1><a class="anchor" id="yarpdatadumper_conf_file"></a>
Configuration Files</h1>
<p>None.</p>
<h1><a class="anchor" id="yarpdatadumper_example"></a>
Example</h1>
<p>By launching the following command:</p>
<div class="fragment"><div class="line">yarpdatadumper --name /log --type image --downsample 2</div>
</div><!-- fragment --><p>the service will create the listening port <code>/log</code> capable of storing images within the subdirectory <code>./log</code> at a halved rate with respect to the rate of the sender.</p>
<p>Then, by connecting the port to the sender with the usual yarp command</p>
<div class="fragment"><div class="line"><a class="code" href="namespaceyarp.html">yarp</a> connect /grabber /log</div>
</div><!-- fragment --><p>the acquisition will start.</p>
<p>By pressing <code>CTRL+C</code> the acquisition is terminated.</p>
<p>So, now, have a look inside the directory <code>./log</code></p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="yarpdataplayer.html">yarpdataplayer: replay recorded data</a> </dd>
<dd>
<a class="el" href="yarpdatadumperAppGenerator.html">yarpdatadumperAppGenerator: Generate yarpmanager applications for yarpdatadumper</a> </dd></dl>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li><span id="projectname_footer">YARP</span></li>
    <li><span id="projectnumber" class="version_switch">3.4.6</span></li>
    <li class="footer">Generated on Sat Jul 3 2021 02:17:08 for YARP by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
