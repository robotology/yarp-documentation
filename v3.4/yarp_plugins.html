<!-- HTML header for doxygen 1.8.12-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>YARP: Ways to compile YARP plugins</title>
<link rel="shortcut icon" href="yarp-favicon.ico" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">
    var DOCUMENTATION_OPTIONS = { VERSION: '3.4.6' };
</script>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="yarp-doxygen-style.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../version_switch.js"></script>
<link rel="stylesheet" type="text/css" href="cookieconsent.min.css" />
<script src="cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#eb6c44",
      "text": "#ffffff"
    },
    "button": {
      "background": "#237afc",
    }
  },
  "theme": "classic",
  "content": {
    "message": "INFORMATION NOTICE ON COOKIES : This website uses only browsing/session cookies. Users can choose whether or not to accept the use of cookies and access the website. By clicking on \"Further information\", the full information notice on the types of cookies will be displayed and you will be able  to choose whether or not to accept them whilst browsing on the website.",
    "dismiss": "ACCEPT and close",
    "link": "Further information",
    "href": "http://www.icub.org/other/personal_data_notice.html"
  }
})});
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="yarp-robot-64.png"/></td>
  <td id="projectalign" style="padding-left: 1.5em;">
   <div id="projectname">YARP</div>
   <div id="projectbrief">Yet Another Robot Platform</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('yarp_plugins.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Ways to compile YARP plugins </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#yarp_plugins_warning">Warning to YARP users</a></li>
<li class="level1"><a href="#yarp_plugins_basics">The basics</a></li>
<li class="level1"><a href="#yarp_plugins_listing">Listing plugins available at runtime</a></li>
<li class="level1"><a href="#yarp_plugins_config">Plugin configuration files</a></li>
<li class="level1"><a href="#yarp_plugins_library">Finding library files</a></li>
</ul>
</div>
<div class="textblock"><p>This documents an area of YARP that is in flux: runtime plugins.</p>
<p>Subject to change during early 2013.</p>
<p>For examples in this section, we assume a Linux environment.</p>
<p>Historically, YARP plugins have been selected at compile-time, and linked with the YARP_init library. At the time of writing, this remains the default. However, it is now also possible to load YARP plugins at runtime.</p>
<h1><a class="anchor" id="yarp_plugins_warning"></a>
Warning to YARP users</h1>
<p>If you are a USER of YARP, rather than a PACKAGER of YARP then consider sticking with the default operation of plugins rather than runtime loading. Runtime loading adds extra ways for things to go wrong, and more paths to keep track of.</p>
<h1><a class="anchor" id="yarp_plugins_basics"></a>
The basics</h1>
<p>For runtime loading of plugins, it is important to enable the following CMake flag when compiling those plugins: </p><ul>
<li>BUILD_SHARED_LIBS = ON</li>
</ul>
<p>Only shared libraries (.so/.dll/.dylib) can be loaded at runtime. YARP plugins are enabled by default, in order to disable them you can set to <code>OFF</code> the following options:</p>
<ul>
<li>YARP_COMPILE_DEVICE_PLUGINS </li>
<li>YARP_COMPILE_CARRIER_PLUGINS</li>
</ul>
<p>The most important plugins are enabled by default, but you can select or deselect each plugin by changing the value of the corresponding option, for example:</p>
<ul>
<li>ENABLE_yarpmod_fakebot = ON </li>
<li>ENABLE_yarpcar_human_carrier = ON</li>
</ul>
<p>This would give us a device called "fakebot" (that generates visual imagery from a simple simulated pan/tilt camera) and a carrier called "human" (a test carrier that actually requires a human agent to pass on messages from one port to another).</p>
<h1><a class="anchor" id="yarp_plugins_listing"></a>
Listing plugins available at runtime</h1>
<p>To list all plugins available at runtime, use "yarp plugin". Once YARP is compiled with the settings given in <a class="el" href="yarp_plugins.html#yarp_plugins_basics">The basics</a>, the list should include a carrier called "human" and a device called "fakebot":</p>
<pre class="fragment">$ ./bin/yarp plugin
List of runtime plugins:

carrier human
  human (type carrier) (name human) (library yarp_human) (part human_carrier) (code HUMANITY)
  found by linking to /.../yarp2/build/lib/libyarp_human.so

device fakebot
  fakebot (type device) (name fakebot) (library yarp_fakebot) (part fakebot)
  found by linking to /.../yarp2/build/lib/libyarp_fakebot.so
</pre><p>In fact, those plugins are also "compiled in" to YARP, as normal.</p>
<p>If we now recompile yarp with ENABLE_yarpmod_fakebot and ENABLE_yarpcar_human_carrier turned OFF, these plugins are no longer compiled into YARP. But unless we have actually removed the library files we already built (libyarp_fakebot.so and libyarp_human.so), YARP will still be able to find them and load them at runtime. Running <code>./bin/yarp plugin</code> should give the same results as before.</p>
<h1><a class="anchor" id="yarp_plugins_config"></a>
Plugin configuration files</h1>
<p>To load a plugin, YARP needs to know three things:</p>
<ul>
<li>the name of the library that implements the plugin </li>
<li>the location of that library </li>
<li>the name of a C function within that library that it can query for information about the plugin in a standard way.</li>
</ul>
<p>However, at the point where a plugin is needed, YARP will know just one of the following: </p><ul>
<li>the name of the device that the plugin corresponds to, which should match whatever was given in a CMake <code>YARP_PREPARE_DEVICE(devicename ...)</code> call, OR </li>
<li>the name of the carrier that the plugin corresponds to, as determined in the carrier's implementation of Carrier::getName, OR </li>
<li>the first 8 bytes sniffed on an incoming TCP connection.</li>
</ul>
<p>To get from this point to activating the right plugin, YARP uses a set of "fingerprint" files. For a carrier they look like this: </p><div class="fragment"><div class="line">[plugin human]      # <span class="stringliteral">&quot;human&quot;</span> here is an arbitrary unique identifier</div>
<div class="line">type carrier        # is the plugin a <span class="stringliteral">&quot;carrier&quot;</span> or a <span class="stringliteral">&quot;device&quot;</span>?</div>
<div class="line">name human          # the name of the plugin, as far as users are concerned</div>
<div class="line">library yarp_human  # the name of the library containing the plugin</div>
<div class="line"><span class="preprocessor">                    # (omitting OS-specific prefixes and suffixes)</span></div>
<div class="line">part human_carrier  # <span class="keyword">function</span> name: match yarp_prepare_carrier(THIS_NAME ...)</div>
<div class="line">code <span class="stringliteral">&quot;HUMANITY&quot;</span>     # the first 8 bytes on <span class="keyword">this</span> kind of connection</div>
</div><!-- fragment --><p>The <code>code</code> line can have single byte wildcards with the following slightly odd syntax (subject to revision): </p><div class="fragment"><div class="line">code (any) (any) <span class="stringliteral">&quot;\0\0&quot;</span> (any) (any) <span class="stringliteral">&quot;\0\0&quot;</span></div>
</div><!-- fragment --><p> That would represent <code>/..\0\0..\0\0/</code> in regular expression syntax.</p>
<p>For a device, the fingerprint files are similar, but don't need the code line: </p><div class="fragment"><div class="line">[plugin fakebot]     # <span class="stringliteral">&quot;fakebot&quot;</span> here is an arbitrary unique identifier</div>
<div class="line">type device          # is the plugin a <span class="stringliteral">&quot;carrier&quot;</span> or a <span class="stringliteral">&quot;device&quot;</span>?</div>
<div class="line">name fakebot         # the name of the plugin, as far as users are concerned</div>
<div class="line">library yarp_fakebot # the name of the library containing the plugin</div>
<div class="line"><span class="preprocessor">                     # (omitting OS-specific prefixes and suffixes)</span></div>
<div class="line"><span class="preprocessor">part fakebot         # function name: match yarp_prepare_device(THIS_NAME ...)</span></div>
</div><!-- fragment --><p>It is fine for a fingerprint file to contain more than one plugin section. The name of the fingerprint is arbitrary, but the extension should be <code>.ini</code>. Examples can be found in the YARP source code, in subdirectories of the <code>src/devices</code> and <code>src/carriers</code> directories.</p>
<p>YARP is configured to aggregate <code>plugin.ini</code> files in a directory called <code>etc/yarp/plugins</code>. The <code>ini</code> files are collected in this directory irrespective of whether the corresponding plugins are compiled or not. To add plugins not included with YARP, an <code>ini</code> file may be placed in <code>etc/yarp/plugins</code>.</p>
<p>YARP looks for <code>etc/yarp/plugins</code> using a <a class="el" href="classyarp_1_1os_1_1ResourceFinder.html" title="Helper class for finding config files and other external resources.">yarp::os::ResourceFinder</a>. If you don't already use configuration files with YARP, one way to get going would be to create a file in your home directory called <code>.yarp/plugins.ini</code> (or <code>yarp\plugins.ini</code> on Windows) containing: </p><div class="fragment"><div class="line">style capability</div>
<div class="line">default_capability /path/to/your/<a class="code" href="namespaceyarp.html">yarp</a>/build</div>
<div class="ttc" id="anamespaceyarp_html"><div class="ttname"><a href="namespaceyarp.html">yarp</a></div><div class="ttdoc">The main, catch-all namespace for YARP.</div><div class="ttdef"><b>Definition:</b> <a href="environment_8h_source.html#l00018">environment.h:18</a></div></div>
</div><!-- fragment --><p> and then set a <code>YARP_POLICY</code> environment variable to <code>plugins</code> (matching the name of the ini file you placed in the <code>.yarp</code>/<code>yarp</code> directory).</p>
<h1><a class="anchor" id="yarp_plugins_library"></a>
Finding library files</h1>
<p>Each operating system has a convention for finding library files which YARP will also use (<code>LD_LIBRARY_PATH</code> etc), with one addition. Once the configuration files in <code>etc/yarp/plugins</code> can be found, YARP will also use any "search" blocks it finds there. They look like this: </p><div class="fragment"><div class="line">[search basic]   # basic is an arbitrary unique identifier</div>
<div class="line">path <span class="stringliteral">&quot;/path/to/directory/to/try&quot;</span>  # possible path to library</div>
<div class="line">extension <span class="stringliteral">&quot;.so&quot;</span>  # extension the libraries use</div>
<div class="line">prefix <span class="stringliteral">&quot;lib&quot;</span>     # prefix the libraries use</div>
<div class="line">type <span class="stringliteral">&quot;shared&quot;</span>    # type of library (should always be <span class="stringliteral">&quot;shared&quot;</span>)</div>
</div><!-- fragment --><p>By default, YARP will add a search block in a file called <code>path.ini</code> which gives the path to where YARP libraries have been placed after compilation (or installation). </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li><span id="projectname_footer">YARP</span></li>
    <li><span id="projectnumber" class="version_switch">3.4.6</span></li>
    <li class="footer">Generated on Sat Jul 3 2021 02:17:09 for YARP by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
