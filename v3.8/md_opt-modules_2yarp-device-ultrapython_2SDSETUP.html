<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>YARP: 1. Ubuntu SD card creation for Enclustra</title>
<link rel="shortcut icon" href="yarp-favicon.ico" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">
    var DOCUMENTATION_OPTIONS = { VERSION: '3.8.1' };
</script>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="yarp-doxygen-style.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../version_switch.js"></script>
<script src="https://cookiehub.net/c2/44d56061.js"></script>
<script type="text/javascript">
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('consent', 'default', {'ad_storage': 'denied', 'analytics_storage': 'denied', 'wait_for_update': 500});
document.addEventListener("DOMContentLoaded", function(event) {
var cpm = {};
window.cookiehub.load(cpm);
});
</script>
<!--
<link rel="stylesheet" type="text/css" href="cookieconsent.min.css" />
<script src="cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#eb6c44",
      "text": "#ffffff"
    },
    "button": {
      "background": "#237afc",
    }
  },
  "theme": "classic",
  "content": {
    "message": "INFORMATION NOTICE ON COOKIES : This website uses only browsing/session cookies. Users can choose whether or not to accept the use of cookies and access the website. By clicking on \"Further information\", the full information notice on the types of cookies will be displayed and you will be able  to choose whether or not to accept them whilst browsing on the website.",
    "dismiss": "ACCEPT and close",
    "link": "Further information",
    "href": "http://www.icub.eu/other/personal_data_notice.html"
  }
})});
</script>
-->
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="yarp-robot-64.png"/></td>
  <td id="projectalign" style="padding-left: 1.5em;">
   <div id="projectname">YARP</div>
   <div id="projectbrief">Yet Another Robot Platform</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_opt-modules_2yarp-device-ultrapython_2SDSETUP.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">1. Ubuntu SD card creation for Enclustra</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md1102"></a> :exclamation:<b>Disclaimed:</b></p>
<ul>
<li>This procedure can be used only if the new Ubuntu system kernel is 5.4.0 version.</li>
<li>Enclustra is an Arm64 board, do not try the x86 Linux version.</li>
</ul>
<h1><a class="anchor" id="autotoc_md1103"></a>
1.1. Download and flash</h1>
<p>:exclamation:<u>To be done on SD card mounted on iCub-head.</u></p>
<p>Create an ubuntu SD card. <br  />
 Suggested site: <a href="https://ubuntu.com/tutorials/how-to-install-ubuntu-on-your-raspberry-pi#1-overview">https://ubuntu.com/tutorials/how-to-install-ubuntu-on-your-raspberry-pi#1-overview</a></p>
<p>Download prebuild Ubuntu 20.04.1 for Arm64:</p>
<div class="fragment"><div class="line">wget https://cdimage.ubuntu.com/releases/20.04.1/release/ubuntu-20.04.1-preinstalled-server-arm64+raspi.img.xz?_ga=2.193426350.2036444557.1610970210-2073042528.1610970210</div>
<div class="line"> </div>
<div class="line">https://ubuntu.com/download/raspberry-pi/thank-you?version=20.04.1&amp;architecture=server-arm64+raspi</div>
<div class="line"> </div>
<div class="line">unxz ubuntu-20.04.1-preinstalled-server-arm64+raspi.img.xz</div>
</div><!-- fragment --><p>Use <a href="https://www.balena.io/etcher/">https://www.balena.io/etcher/</a> application to flash the SD card with the above file.</p>
<p>:exclamation:Use <code>gparted</code> application to enlarge partition up to 16GB</p>
<h1><a class="anchor" id="autotoc_md1104"></a>
1.2. Override Ubuntu Kernel</h1>
<p>:exclamation:<u>To be done on SD card mounted on iCub-head.</u></p>
<p>Copy from <code>yarp-device-ultrapython/ubuntu-files/system-boot</code> to new card <code>/system-boot</code> (<b>not /boot</b>)</p>
<p>The following files can be removed from /system-boot. <br  />
 //TODO</p>
<h1><a class="anchor" id="autotoc_md1105"></a>
1.3. Delete locked password</h1>
<p>:exclamation:<u>To be done on SD card mounted on iCub-head.</u></p>
<p>Modify shadows file.</p>
<div class="fragment"><div class="line">sudo vi /mount/&lt;mount location&gt;/etc/shadows</div>
</div><!-- fragment --><p>Follow link: <a href="https://www.justdocloud.com/2020/05/10/how-to-remove-password-from-etc-shadow/">https://www.justdocloud.com/2020/05/10/how-to-remove-password-from-etc-shadow/</a></p>
<p>and remove the password for the root user.</p>
<h1><a class="anchor" id="autotoc_md1106"></a>
1.4. Network config</h1>
<p>:exclamation:<u>To be done on SD card mounted on iCub-head.</u></p>
<p>Follow link: <a href="https://linuxize.com/post/how-to-configure-static-ip-address-on-ubuntu-18-04/">https://linuxize.com/post/how-to-configure-static-ip-address-on-ubuntu-18-04/</a></p>
<p>Copy file:</p>
<div class="fragment"><div class="line">cp &lt;myroot&gt;/yarp-device-ultrapython/ubuntu-files/config/01-netcfg.yaml /mount/&lt;mountpoint&gt;/etc/netplan/01-netcfg.yaml</div>
</div><!-- fragment --><p>In case the configuration is done on running Enclustra</p>
<div class="fragment"><div class="line">sudo netplan apply</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1107"></a>
1.5. Generate ssh key for root access on Enclustra</h1>
<p>:exclamation:<u>To be done on SD card mounted on iCub-head.</u></p>
<div class="fragment"><div class="line">su &lt;your user or root&gt;</div>
<div class="line">ssh-keygen</div>
</div><!-- fragment --><p>For ssh-keygen keep all default suggestions.</p>
<p>Copy and paste contents of <code>/home/&lt;your user&gt;/.ssh/id_rsa.pub</code> from local Linux machine to <code>/root/.ssh/authorized_keys</code> in SD card (as root user).</p>
<p>Note that you can generate the key also for other accounts on iCub-head.</p>
<p>Add board hostname on iCub-head (not mandatory)</p>
<div class="fragment"><div class="line">cd ~\.ssh</div>
<div class="line">mkdir config</div>
</div><!-- fragment --><p>Paste in the file config</p>
<div class="fragment"><div class="line">Host enclustra</div>
<div class="line">     Hostname 10.0.1.233</div>
<div class="line">     port 22</div>
<div class="line">     user root</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1108"></a>
1.6. Missing package</h1>
<p>:exclamation:<u>To be done on running Enclustra.</u></p>
<p>Use the serial connection if ssh won't work.</p>
<div class="fragment"><div class="line">apt update</div>
<div class="line">apt remove initramfs-tools cryptsetup snapd</div>
<div class="line">install net-tools g++ build-essential cmake cmake-curses-gui v4l-utils mplayer netcat pv ssh clang libssl-dev git libncurses5-dev libace-dev libv4l-dev libv4lconvert0 libopencv-dev cppcheck clang-format libudev-dev ntpdate</div>
</div><!-- fragment --><p>Execute: <code>apt upgrade</code> It can give some errors, you can ignore and in this case again: <code>apt remove initramfs-tools cryptsetup</code></p>
<p>Add root pwd:</p>
<div class="fragment"><div class="line">pwd</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1109"></a>
1.7. Others</h1>
<p>:exclamation:<u>To be done on running Enclustra.</u> <br  />
 Disable the wait-online service to prevent the system from waiting on a network connection.</p>
<div class="fragment"><div class="line">systemctl disable systemd-networkd-wait-online.service</div>
<div class="line">systemctl mask systemd-networkd-wait-online.services</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1110"></a>
1.8. YARP</h1>
<p>:exclamation:<u>To be done on running Enclustra.</u></p>
<div class="fragment"><div class="line">cd icubtech</div>
<div class="line"> </div>
<div class="line">git clone https://github.com/robotology/ycm.git</div>
<div class="line">mkdir build</div>
<div class="line">cd build</div>
<div class="line">cmake ..</div>
<div class="line">make</div>
<div class="line"> </div>
<div class="line">git clone https://github.com/robotology/yarp.git</div>
<div class="line">mkdir build</div>
<div class="line">cd build</div>
<div class="line">cmake ..</div>
<div class="line">make</div>
</div><!-- fragment --><p>Select as <code>YCM_DIR</code> <code>/root/icubtech/ycm/build</code> for YARP</p>
<p>Select as <code>CMAKE_INSTALL_PREFIX</code> <code>/root/icubtech/install</code> for both YCM and YARP</p>
<p>Add to .bashrc:</p>
<div class="fragment"><div class="line">export YARP_DIR=/root/icubtech/install</div>
<div class="line">export YARP_DATA_DIRS=${YARP_DIR}/share/yarp</div>
<div class="line">export PATH=$PATH:${YARP_DIR}/bin</div>
<div class="line">export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:${YARP_DIR}/lib</div>
</div><!-- fragment --><p>Get and install kernel modules.</p>
<div class="fragment"><div class="line">cd /root/icubtech/python-camera/</div>
<div class="line">git clone https://github.com/icub-tech-iit/yarp-device-ultrapython.git</div>
<div class="line">cp /root/icubtech/python-camera/ubuntu-files/config/rc.local /etc</div>
<div class="line">chmod +x /etc/rc.local</div>
</div><!-- fragment --><p>Now <code>reboot</code> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li><span id="projectname_footer">YARP</span></li>
    <li><span id="projectnumber" class="version_switch">3.8.1</span></li>
    <li class="footer">Generated on Wed Sep 13 2023 08:44:47 for YARP by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
