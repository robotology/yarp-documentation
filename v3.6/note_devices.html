<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>YARP: Getting Started with YARP Devices</title>
<link rel="shortcut icon" href="yarp-favicon.ico" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">
    var DOCUMENTATION_OPTIONS = { VERSION: '3.6.0' };
</script>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="yarp-doxygen-style.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../version_switch.js"></script>
<link rel="stylesheet" type="text/css" href="cookieconsent.min.css" />
<script src="cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#eb6c44",
      "text": "#ffffff"
    },
    "button": {
      "background": "#237afc",
    }
  },
  "theme": "classic",
  "content": {
    "message": "INFORMATION NOTICE ON COOKIES : This website uses only browsing/session cookies. Users can choose whether or not to accept the use of cookies and access the website. By clicking on \"Further information\", the full information notice on the types of cookies will be displayed and you will be able  to choose whether or not to accept them whilst browsing on the website.",
    "dismiss": "ACCEPT and close",
    "link": "Further information",
    "href": "http://www.icub.org/other/personal_data_notice.html"
  }
})});
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="yarp-robot-64.png"/></td>
  <td id="projectalign" style="padding-left: 1.5em;">
   <div id="projectname">YARP</div>
   <div id="projectbrief">Yet Another Robot Platform</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('note_devices.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Getting Started with YARP Devices </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#note_devices_yarp">YARP Devices</a></li>
<li class="level1"><a href="#note_devices_example">Framegrabber interfaces</a></li>
<li class="level1"><a href="#note_devices_library">Creating and configuring the new device</a><ul><li class="level2"><a href="#note_devices_list">Find out available devices and their parameters</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p>For robotics, we need access to all sorts of strange devices.</p>
<p>This section contains a tutorial on the YARP view of what devices are. If you just want to get coding immediately, see the <a class="el" href="group__dev__all.html">main page for YARP Devices</a>, including information on interfaces, implementation, configuration and <a class="el" href="">commandline</a> usage.</p>
<h1><a class="anchor" id="note_devices_yarp"></a>
YARP Devices</h1>
<p>There are three separate concerns related to devices in YARP:</p>
<ul>
<li>Implementing specific drivers for particular devices </li>
<li>Defining interfaces for device families </li>
<li>Implementing network wrappers for interfaces</li>
</ul>
<p>The first step, creating drivers for particular devices, is obvious; every robotics project needs to interface with hardware somehow.</p>
<p>The second step, defining interfaces for families of devices, is important in the longer term. If you change your camera or your motor control board, how much of your code needs to change too? If you view your devices through well thought out interfaces, the impact of device change can be minimized.</p>
<p>The third step, network wrappers, is important to give flexibility. You can scale up your computing cluster, or isolate hardware devices that don't play well together, or have specific OS dependencies etc.</p>
<p>A driver in YARP is just a C++ class. Interfaces are simply abstract base classes. And network wrappers are just special cases of devices that happen to use network resources to satisfy their interfaces. Let's look at some examples to make this clear.</p>
<h1><a class="anchor" id="note_devices_example"></a>
Framegrabber interfaces</h1>
<p>We call devices that produce a stream of images "framegrabbers" for historical reasons. There are a number of interfaces associated with framegrabbers. Here's one, IFrameGrabberImage:</p>
<div class="fragment"><div class="line"><span class="keyword">class </span><a class="code" href="classyarp_1_1dev_1_1IFrameGrabberOf.html">yarp::dev::IFrameGrabberImage</a> {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classyarp_1_1dev_1_1IFrameGrabberOf.html#a763d5ef533157ad36d5c8b11866a76f3">getImage</a>(<a class="code" href="classyarp_1_1sig_1_1ImageOf.html">yarp::sig::ImageOf&lt;yarp::sig::PixelRgb&gt;</a>&amp; image) = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classyarp_1_1dev_1_1IFrameGrabberImageBase.html#a8aab3153eab8d380c323afa058484cdb">height</a>() <span class="keyword">const</span> = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classyarp_1_1dev_1_1IFrameGrabberImageBase.html#a37e377965b3824b3b266177a9dd3e387">width</a>() <span class="keyword">const</span> = 0;</div>
<div class="line">};</div>
<div class="ttc" id="aclassyarp_1_1dev_1_1IFrameGrabberImageBase_html_a37e377965b3824b3b266177a9dd3e387"><div class="ttname"><a href="classyarp_1_1dev_1_1IFrameGrabberImageBase.html#a37e377965b3824b3b266177a9dd3e387">yarp::dev::IFrameGrabberImageBase::width</a></div><div class="ttdeci">virtual int width() const =0</div><div class="ttdoc">Return the width of each frame.</div></div>
<div class="ttc" id="aclassyarp_1_1dev_1_1IFrameGrabberImageBase_html_a8aab3153eab8d380c323afa058484cdb"><div class="ttname"><a href="classyarp_1_1dev_1_1IFrameGrabberImageBase.html#a8aab3153eab8d380c323afa058484cdb">yarp::dev::IFrameGrabberImageBase::height</a></div><div class="ttdeci">virtual int height() const =0</div><div class="ttdoc">Return the height of each frame.</div></div>
<div class="ttc" id="aclassyarp_1_1dev_1_1IFrameGrabberOf_html"><div class="ttname"><a href="classyarp_1_1dev_1_1IFrameGrabberOf.html">yarp::dev::IFrameGrabberOf</a></div><div class="ttdef"><b>Definition:</b> <a href="IFrameGrabberImage_8h_source.html#l00050">IFrameGrabberImage.h:52</a></div></div>
<div class="ttc" id="aclassyarp_1_1dev_1_1IFrameGrabberOf_html_a763d5ef533157ad36d5c8b11866a76f3"><div class="ttname"><a href="classyarp_1_1dev_1_1IFrameGrabberOf.html#a763d5ef533157ad36d5c8b11866a76f3">yarp::dev::IFrameGrabberOf::getImage</a></div><div class="ttdeci">virtual bool getImage(ImageType &amp;image)=0</div><div class="ttdoc">Get an image from the frame grabber.</div></div>
<div class="ttc" id="aclassyarp_1_1sig_1_1ImageOf_html"><div class="ttname"><a href="classyarp_1_1sig_1_1ImageOf.html">yarp::sig::ImageOf&lt; yarp::sig::PixelRgb &gt;</a></div></div>
</div><!-- fragment --><p>Notice that IFrameGrabberImage doesn't do anything itself &ndash; it just declares methods to get an image and image dimensions. There are several classes in YARP that implement this interface (in other words, they inherit from it and define the methods). One example is DragonflyDeviceDriver. This interfaces with a Point Grey digital camera, using different libraries on different operating systems. It implements several interfaces; here are just two of them:</p>
<div class="dotgraph">
<img src="dot_inline_dotgraph_8.png" alt="dot_inline_dotgraph_8.png" border="0" usemap="#dot_inline_dotgraph_8.map"/>
</div>
<p>Since you may not have any hardware devices available to you right now, let's make a "fake" framegrabber that implements the IFrameGrabberImage interface:</p>
<div class="fragment"><div class="line"><span class="keyword">class </span><a class="code" href="classFakeFrameGrabber.html">FakeFrameGrabber</a> : <span class="keyword">public</span> <a class="code" href="namespaceyarp_1_1dev.html#a38f106a310974d842363a9fbc733d136">IFrameGrabberImage</a> {</div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    <span class="keywordtype">int</span> w, <span class="keywordtype">int</span> h;</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <a class="code" href="classFakeFrameGrabber.html#a8ff267cce8e2ae58c670b19a4821ad85">FakeFrameGrabber</a>(<span class="keywordtype">int</span> w, <span class="keywordtype">int</span> h) : w(w), h(h) {</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classFakeFrameGrabber.html#ae277aa487717c7c4eed0f3151dc45fca">getImage</a>(<a class="code" href="classyarp_1_1sig_1_1ImageOf.html">yarp::sig::ImageOf&lt;yarp::sig::PixelRgb&gt;</a>&amp; image) {</div>
<div class="line">    <a class="code" href="namespaceyarp_1_1os_1_1Time.html#aca80809e0597551745954e2547e581ee">Time::delay</a>(0.5);  <span class="comment">// simulate waiting for hardware to report</span></div>
<div class="line">    image.<a class="code" href="classyarp_1_1sig_1_1Image.html#a973864b80bf12a2f1575234d8d64fc37">resize</a>(w,h);</div>
<div class="line">    image.<a class="code" href="classyarp_1_1sig_1_1Image.html#ab43564f91395e59e84707845f4328e98">zero</a>();</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classFakeFrameGrabber.html#a50a1bf7ffd94c8d59c186a348530fa30">height</a>()<span class="keyword"> const </span>{</div>
<div class="line">    <span class="keywordflow">return</span> h;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classFakeFrameGrabber.html#a04553de065a77b39ec3c82ca30708ae7">width</a>()<span class="keyword"> const </span>{</div>
<div class="line">    <span class="keywordflow">return</span> w;</div>
<div class="line">    }</div>
<div class="line">};</div>
<div class="ttc" id="aclassFakeFrameGrabber_html"><div class="ttname"><a href="classFakeFrameGrabber.html">FakeFrameGrabber</a></div><div class="ttdoc">fakeFrameGrabber: A fake camera for testing.</div><div class="ttdef"><b>Definition:</b> <a href="FakeFrameGrabber_8h_source.html#l00037">FakeFrameGrabber.h:51</a></div></div>
<div class="ttc" id="aclassFakeFrameGrabber_html_a04553de065a77b39ec3c82ca30708ae7"><div class="ttname"><a href="classFakeFrameGrabber.html#a04553de065a77b39ec3c82ca30708ae7">FakeFrameGrabber::width</a></div><div class="ttdeci">int width() const override</div><div class="ttdoc">Return the width of each frame.</div><div class="ttdef"><b>Definition:</b> <a href="FakeFrameGrabber_8cpp_source.html#l00378">FakeFrameGrabber.cpp:378</a></div></div>
<div class="ttc" id="aclassFakeFrameGrabber_html_a50a1bf7ffd94c8d59c186a348530fa30"><div class="ttname"><a href="classFakeFrameGrabber.html#a50a1bf7ffd94c8d59c186a348530fa30">FakeFrameGrabber::height</a></div><div class="ttdeci">int height() const override</div><div class="ttdoc">Return the height of each frame.</div><div class="ttdef"><b>Definition:</b> <a href="FakeFrameGrabber_8cpp_source.html#l00374">FakeFrameGrabber.cpp:374</a></div></div>
<div class="ttc" id="aclassFakeFrameGrabber_html_a8ff267cce8e2ae58c670b19a4821ad85"><div class="ttname"><a href="classFakeFrameGrabber.html#a8ff267cce8e2ae58c670b19a4821ad85">FakeFrameGrabber::FakeFrameGrabber</a></div><div class="ttdeci">FakeFrameGrabber()=default</div></div>
<div class="ttc" id="aclassFakeFrameGrabber_html_ae277aa487717c7c4eed0f3151dc45fca"><div class="ttname"><a href="classFakeFrameGrabber.html#ae277aa487717c7c4eed0f3151dc45fca">FakeFrameGrabber::getImage</a></div><div class="ttdeci">bool getImage(yarp::sig::ImageOf&lt; yarp::sig::PixelRgb &gt; &amp;image) override</div><div class="ttdef"><b>Definition:</b> <a href="FakeFrameGrabber_8cpp_source.html#l00478">FakeFrameGrabber.cpp:478</a></div></div>
<div class="ttc" id="aclassyarp_1_1sig_1_1Image_html_a973864b80bf12a2f1575234d8d64fc37"><div class="ttname"><a href="classyarp_1_1sig_1_1Image.html#a973864b80bf12a2f1575234d8d64fc37">yarp::sig::Image::resize</a></div><div class="ttdeci">void resize(size_t imgWidth, size_t imgHeight)</div><div class="ttdoc">Reallocate an image to be of a desired size, throwing away its current contents.</div><div class="ttdef"><b>Definition:</b> <a href="Image_8cpp_source.html#l00452">Image.cpp:452</a></div></div>
<div class="ttc" id="aclassyarp_1_1sig_1_1Image_html_ab43564f91395e59e84707845f4328e98"><div class="ttname"><a href="classyarp_1_1sig_1_1Image.html#ab43564f91395e59e84707845f4328e98">yarp::sig::Image::zero</a></div><div class="ttdeci">void zero()</div><div class="ttdoc">Set all pixels to 0.</div><div class="ttdef"><b>Definition:</b> <a href="Image_8cpp_source.html#l00445">Image.cpp:445</a></div></div>
<div class="ttc" id="anamespaceyarp_1_1dev_html_a38f106a310974d842363a9fbc733d136"><div class="ttname"><a href="namespaceyarp_1_1dev.html#a38f106a310974d842363a9fbc733d136">yarp::dev::IFrameGrabberImage</a></div><div class="ttdeci">IFrameGrabberOf&lt; yarp::sig::ImageOf&lt; yarp::sig::PixelRgb &gt; &gt; IFrameGrabberImage</div><div class="ttdef"><b>Definition:</b> <a href="IFrameGrabberImage_8h_source.html#l00081">IFrameGrabberImage.h:81</a></div></div>
<div class="ttc" id="anamespaceyarp_1_1os_1_1Time_html_aca80809e0597551745954e2547e581ee"><div class="ttname"><a href="namespaceyarp_1_1os_1_1Time.html#aca80809e0597551745954e2547e581ee">yarp::os::Time::delay</a></div><div class="ttdeci">void delay(double seconds)</div><div class="ttdoc">Wait for a certain number of seconds.</div><div class="ttdef"><b>Definition:</b> <a href="Time_8cpp_source.html#l00111">Time.cpp:111</a></div></div>
</div><!-- fragment --><p>All this does is return blank images roughly every half second, but it does indeed implement the IFrameGrabberImage interface.</p>
<p>We very nearly have a YARP device driver. Sometimes we want to be able to create devices flexibly, based on a configuration file, or without having to worry about where their header file is. For these purposes, YARP requires that: </p><ul>
<li>All device drivers inherit from the "DeviceDriver" class. </li>
<li>All device drivers implement an <em>open</em> and <em>close</em> method. </li>
<li>Device drivers should be using no hardware resources before open is called or after close is called. YARP in return will promise that <em>open</em> will be the first method called after construction, and that if open returns false no other methods will be called before destruction. The <em>open</em> method takes a configuration object which can contain arbitrary properties.</li>
</ul>
<p>This is quite straightforward to do for our fake framegrabber:</p>
<div class="fragment"><div class="line"><span class="keyword">class </span><a class="code" href="classFakeFrameGrabber.html">FakeFrameGrabber</a> : <span class="keyword">public</span> <a class="code" href="namespaceyarp_1_1dev.html#a38f106a310974d842363a9fbc733d136">IFrameGrabberImage</a>,</div>
<div class="line">             <span class="keyword">public</span> <a class="code" href="classyarp_1_1dev_1_1DeviceDriver.html">yarp::dev::DeviceDriver</a> {</div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    <span class="keywordtype">int</span> w, <span class="keywordtype">int</span> h;</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <a class="code" href="classFakeFrameGrabber.html#a8ff267cce8e2ae58c670b19a4821ad85">FakeFrameGrabber</a>() {</div>
<div class="line">    h = w = 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">bool</span> <a class="code" href="classFakeFrameGrabber.html#a9ddf08b24b0ae18c4e8e6a902d5328cb">open</a>(<span class="keywordtype">int</span> w, <span class="keywordtype">int</span> h) {</div>
<div class="line">    this-&gt;w = w;</div>
<div class="line">    this-&gt;h = h;</div>
<div class="line">    <span class="keywordflow">return</span> w&gt;0 &amp;&amp; h&gt;0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classFakeFrameGrabber.html#a9ddf08b24b0ae18c4e8e6a902d5328cb">open</a>(<a class="code" href="classyarp_1_1os_1_1Searchable.html">yarp::os::Searchable</a>&amp; config) {</div>
<div class="line">    <span class="comment">// extract width and height configuration, if present</span></div>
<div class="line">    <span class="comment">// otherwise use 128x128</span></div>
<div class="line">    <span class="keywordtype">int</span> desiredWidth = config.<a class="code" href="classyarp_1_1os_1_1Searchable.html#aa7b406215b653817f2450ac416b65867">check</a>(<span class="stringliteral">&quot;w&quot;</span>,Value(128)).asInt32();</div>
<div class="line">    <span class="keywordtype">int</span> desiredHeight = config.<a class="code" href="classyarp_1_1os_1_1Searchable.html#aa7b406215b653817f2450ac416b65867">check</a>(<span class="stringliteral">&quot;h&quot;</span>,Value(128)).asInt32();</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="classFakeFrameGrabber.html#a9ddf08b24b0ae18c4e8e6a902d5328cb">open</a>(desiredWidth,desiredHeight);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classFakeFrameGrabber.html#aff4ecdb37f6a383fcd66c586e67cbc24">close</a>() {</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>; <span class="comment">// easy</span></div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classFakeFrameGrabber.html#ae277aa487717c7c4eed0f3151dc45fca">getImage</a>(<a class="code" href="classyarp_1_1sig_1_1ImageOf.html">yarp::sig::ImageOf&lt;yarp::sig::PixelRgb&gt;</a>&amp; image) {</div>
<div class="line">    <a class="code" href="namespaceyarp_1_1os_1_1Time.html#aca80809e0597551745954e2547e581ee">Time::delay</a>(0.5);  <span class="comment">// simulate waiting for hardware to report</span></div>
<div class="line">    image.<a class="code" href="classyarp_1_1sig_1_1Image.html#a973864b80bf12a2f1575234d8d64fc37">resize</a>(w,h);</div>
<div class="line">    image.<a class="code" href="classyarp_1_1sig_1_1Image.html#ab43564f91395e59e84707845f4328e98">zero</a>();</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classFakeFrameGrabber.html#a50a1bf7ffd94c8d59c186a348530fa30">height</a>()<span class="keyword"> const </span>{</div>
<div class="line">    <span class="keywordflow">return</span> h;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classFakeFrameGrabber.html#a04553de065a77b39ec3c82ca30708ae7">width</a>()<span class="keyword"> const </span>{</div>
<div class="line">    <span class="keywordflow">return</span> w;</div>
<div class="line">    }</div>
<div class="line">};</div>
<div class="ttc" id="aclassFakeFrameGrabber_html_a9ddf08b24b0ae18c4e8e6a902d5328cb"><div class="ttname"><a href="classFakeFrameGrabber.html#a9ddf08b24b0ae18c4e8e6a902d5328cb">FakeFrameGrabber::open</a></div><div class="ttdeci">bool open(yarp::os::Searchable &amp;config) override</div><div class="ttdoc">Configure with a set of options.</div><div class="ttdef"><b>Definition:</b> <a href="FakeFrameGrabber_8cpp_source.html#l00222">FakeFrameGrabber.cpp:222</a></div></div>
<div class="ttc" id="aclassFakeFrameGrabber_html_aff4ecdb37f6a383fcd66c586e67cbc24"><div class="ttname"><a href="classFakeFrameGrabber.html#aff4ecdb37f6a383fcd66c586e67cbc24">FakeFrameGrabber::close</a></div><div class="ttdeci">bool close() override</div><div class="ttdoc">Close the DeviceDriver.</div><div class="ttdef"><b>Definition:</b> <a href="FakeFrameGrabber_8cpp_source.html#l00216">FakeFrameGrabber.cpp:216</a></div></div>
<div class="ttc" id="aclassyarp_1_1dev_1_1DeviceDriver_html"><div class="ttname"><a href="classyarp_1_1dev_1_1DeviceDriver.html">yarp::dev::DeviceDriver</a></div><div class="ttdoc">Interface implemented by all device drivers.</div><div class="ttdef"><b>Definition:</b> <a href="DeviceDriver_8h_source.html#l00029">DeviceDriver.h:30</a></div></div>
<div class="ttc" id="aclassyarp_1_1os_1_1Searchable_html"><div class="ttname"><a href="classyarp_1_1os_1_1Searchable.html">yarp::os::Searchable</a></div><div class="ttdoc">A base class for nested structures that can be searched.</div><div class="ttdef"><b>Definition:</b> <a href="Searchable_8h_source.html#l00062">Searchable.h:63</a></div></div>
<div class="ttc" id="aclassyarp_1_1os_1_1Searchable_html_aa7b406215b653817f2450ac416b65867"><div class="ttname"><a href="classyarp_1_1os_1_1Searchable.html#aa7b406215b653817f2450ac416b65867">yarp::os::Searchable::check</a></div><div class="ttdeci">virtual bool check(const std::string &amp;key) const =0</div><div class="ttdoc">Check if there exists a property of the given name.</div></div>
</div><!-- fragment --><p>Now we have a good YARP device driver (even if it is fake). We've chosen to require that the width and height of images be greater than zero, which seems reasonable.</p>
<h1><a class="anchor" id="note_devices_library"></a>
Creating and configuring the new device</h1>
<p>We can create, configure, and use our device directly, without any bureaucracy: </p><div class="fragment"><div class="line"><a class="code" href="classFakeFrameGrabber.html">FakeFrameGrabber</a> fakey;</div>
<div class="line">fakey.<a class="code" href="classFakeFrameGrabber.html#a9ddf08b24b0ae18c4e8e6a902d5328cb">open</a>(640,480);</div>
<div class="line">ImageOf&lt;PixelRgb&gt; img;</div>
<div class="line">fakey.<a class="code" href="classFakeFrameGrabber.html#ae277aa487717c7c4eed0f3151dc45fca">getImage</a>(img);</div>
<div class="line">...</div>
</div><!-- fragment --><p>If we're smart, we'd make as much of our code as possible depend just on the interface IFrameGrabberImage, so that we can reuse it or substitute in a different framegrabber later: </p><div class="fragment"><div class="line"><span class="comment">// creation and configuration -- depends on specific device type</span></div>
<div class="line"><a class="code" href="classFakeFrameGrabber.html">FakeFrameGrabber</a> fakey;</div>
<div class="line">fakey.<a class="code" href="classFakeFrameGrabber.html#a9ddf08b24b0ae18c4e8e6a902d5328cb">open</a>(640,480);</div>
<div class="line"><a class="code" href="namespaceyarp_1_1dev.html#a38f106a310974d842363a9fbc733d136">IFrameGrabberImage</a>&amp; genericGrabber = fakey;</div>
<div class="line"><span class="comment">// from here on, we only care that our device implements IFrameGrabberImage</span></div>
<div class="line">ImageOf&lt;PixelRgb&gt; img;</div>
<div class="line">genericGrabber.<a class="code" href="classFakeFrameGrabber.html#ae277aa487717c7c4eed0f3151dc45fca">getImage</a>(img);</div>
<div class="line">...</div>
</div><!-- fragment --><p> This is a standard software engineering technique for minimizing unnecessary coupling between modules.</p>
<p>Suppose we want to go further, and let the framegrabber we use be controlled by a command line option. So it could either be our <a class="el" href="classFakeFrameGrabber.html" title="fakeFrameGrabber: A fake camera for testing.">FakeFrameGrabber</a>, or a real device like DragonflyDeviceDriver or PicoloDeviceDriver (another framegrabber), or <a class="el" href="classRemoteFrameGrabber.html" title="remote_grabber: Connect to a ServerFrameGrabber. See ServerFrameGrabber for the network protocol used...">RemoteFrameGrabber</a> (a proxy for a framegrabber device on another machine).</p>
<p>YARP comes with a helper for doing this. It maintains a simple database of the drivers you have compiled and available. You can see this database by running "yarpdev", which tells you something like: </p><pre class="fragment">...
Here are devices listed for your system:

Device &lt;dragonfly&gt;
   documented by the C++ class DragonflyDeviceDriver
   Wrapped for the network by &lt;grabber&gt;

Device &lt;fakeFrameGrabber&gt;
   documented by the C++ class FakeFrameGrabber
   Wrapped for the network by &lt;grabber&gt;

Device &lt;grabber&gt;
   documented by the C++ class ServerFrameGrabber
   Does not need a network wrapper.
...
</pre><p> We see a "dragonfly" listing associated with the DragonflyDeviceDriver class &ndash; "dragonfly" is this devices <em>common name</em> to which it is referred to in configuration files, command line options, etc.. There is also a "fakeFrameGrabber" listing associated with a <a class="el" href="classFakeFrameGrabber.html" title="fakeFrameGrabber: A fake camera for testing.">FakeFrameGrabber</a> class &ndash; this is in fact a more elaborate version of the fake framegrabber we've been working on, for testing purposes. We can ignore it for now. There is also a "grabber" device listed, with is a network wrapper that works for all framegrabber devices.</p>
<p>You can instantiate any device listed here from your code as follows: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="PolyDriver_8h.html">yarp/dev/PolyDriver.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="IFrameGrabberImage_8h.html">yarp/dev/IFrameGrabberImage.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="libYARP__sig_2src_2yarp_2sig_2Image_8h.html">yarp/sig/Image.h</a>&gt;</span></div>
<div class="line"><span class="keyword">using</span> <a class="code" href="classyarp_1_1dev_1_1PolyDriver.html">yarp::dev::PolyDriver</a>;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespaceyarp_1_1dev.html#a38f106a310974d842363a9fbc733d136">yarp::dev::IFrameGrabberImage</a>;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="classyarp_1_1sig_1_1ImageOf.html">yarp::sig::ImageOf</a>;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="structyarp_1_1sig_1_1PixelRgb.html">yarp::sig::PixelRgb</a>;</div>
<div class="line">...</div>
<div class="line">PolyDriver dd(<span class="stringliteral">&quot;dragonfly&quot;</span>);</div>
<div class="line"><span class="keywordflow">if</span> (!dd.isValid()) {</div>
<div class="line">  printf(<span class="stringliteral">&quot;Dragonfly not available\n&quot;</span>);</div>
<div class="line">  exit(1);</div>
<div class="line">}</div>
<div class="line"><a class="code" href="namespaceyarp_1_1dev.html#a38f106a310974d842363a9fbc733d136">IFrameGrabberImage</a> *grabber;</div>
<div class="line">dd.view(grabber);</div>
<div class="line"><span class="keywordflow">if</span> (grabber!=NULL) {</div>
<div class="line">  printf(<span class="stringliteral">&quot;*** Device can supply images\n&quot;</span>);</div>
<div class="line">  ImageOf&lt;PixelRgb&gt; img;</div>
<div class="line">  <span class="keywordflow">if</span> (grabber-&gt;getImage(img)) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;*** Got a %zux%zu image\n&quot;</span>, img.width(), img.height());</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="ttc" id="aIFrameGrabberImage_8h_html"><div class="ttname"><a href="IFrameGrabberImage_8h.html">IFrameGrabberImage.h</a></div></div>
<div class="ttc" id="aPolyDriver_8h_html"><div class="ttname"><a href="PolyDriver_8h.html">PolyDriver.h</a></div></div>
<div class="ttc" id="aclassyarp_1_1dev_1_1PolyDriver_html"><div class="ttname"><a href="classyarp_1_1dev_1_1PolyDriver.html">yarp::dev::PolyDriver</a></div><div class="ttdoc">A container for a device driver.</div><div class="ttdef"><b>Definition:</b> <a href="PolyDriver_8h_source.html#l00021">PolyDriver.h:23</a></div></div>
<div class="ttc" id="alibYARP__sig_2src_2yarp_2sig_2Image_8h_html"><div class="ttname"><a href="libYARP__sig_2src_2yarp_2sig_2Image_8h.html">Image.h</a></div></div>
<div class="ttc" id="astructyarp_1_1sig_1_1PixelRgb_html"><div class="ttname"><a href="structyarp_1_1sig_1_1PixelRgb.html">yarp::sig::PixelRgb</a></div><div class="ttdoc">Packed RGB pixel type.</div><div class="ttdef"><b>Definition:</b> <a href="libYARP__sig_2src_2yarp_2sig_2Image_8h_source.html#l00459">Image.h:460</a></div></div>
</div><!-- fragment --><p> Just replace the name "dragonfly" with the device you want.</p>
<p>If we want to be able to create a <a class="el" href="classFakeFrameGrabber.html" title="fakeFrameGrabber: A fake camera for testing.">FakeFrameGrabber</a> through the same mechanism, we need to add a <em>factory</em> for it to the device driver database. Here's how: </p><div class="fragment"><div class="line">DriverCreator *fakey_factory =</div>
<div class="line">   <span class="keyword">new</span> DriverCreatorOf&lt;FakeFrameGrabber&gt;(<span class="stringliteral">&quot;fakey&quot;</span>,<span class="stringliteral">&quot;grabber&quot;</span>,<span class="stringliteral">&quot;FakeFrameGrabber&quot;</span>);</div>
<div class="line">Drivers::factory().add(fakey_factory); <span class="comment">// hand factory over to YARP</span></div>
</div><!-- fragment --><p> The name "fakey" is an arbitrary common name we pick. The name "grabber" gives a network wrapper for this device ("" if there is none). The class name "FakeFrameGrabber" is recorded to let the user know where to look for documentation on this device.</p>
<p>Now we can do: </p><div class="fragment"><div class="line">PolyDriver dd(<span class="stringliteral">&quot;fakey&quot;</span>);</div>
<div class="line"><a class="code" href="namespaceyarp_1_1dev.html#a38f106a310974d842363a9fbc733d136">IFrameGrabberImage</a> *grabber;</div>
<div class="line">dd.view(grabber);</div>
<div class="line"><span class="keywordflow">if</span> (grabber == <span class="keyword">nullptr</span>) { exit(1); } <span class="comment">// failed</span></div>
<div class="line"><span class="comment">// from here on, we only care that our device implements IFrameGrabberImage</span></div>
<div class="line">ImageOf&lt;PixelRgb&gt; img;</div>
<div class="line">grabber-&gt;getImage(img);</div>
<div class="line">...</div>
</div><!-- fragment --><p>This form is calling <a class="el" href="classFakeFrameGrabber.html#a9ddf08b24b0ae18c4e8e6a902d5328cb" title="Configure with a set of options.">FakeFrameGrabber::open</a> without any configuration information set up. To pass in configuration options, we do: </p><div class="fragment"><div class="line">Property config(<span class="stringliteral">&quot;(device fakey) (w 640) (h 480)&quot;</span>);</div>
<div class="line">PolyDriver dd(config);</div>
<div class="line">...</div>
</div><!-- fragment --><p>Once we've reached this point, some fun things become possible. For example: </p><div class="fragment"><div class="line">Property config(<span class="stringliteral">&quot;(device grabberDual) (subdevice fakey) (w 640) (h 480)&quot;</span>);</div>
<div class="line">PolyDriver dd(config);</div>
<div class="line">...</div>
</div><!-- fragment --><p> This will create and configure a <a class="el" href="classFakeFrameGrabber.html" title="fakeFrameGrabber: A fake camera for testing.">FakeFrameGrabber</a>, then wrap it up in a <a class="el" href="classServerFrameGrabber.html" title="grabber: Export a frame grabber to the network.">ServerFrameGrabber</a> so that it can be accessed on the network.</p>
<h2><a class="anchor" id="note_devices_list"></a>
Find out available devices and their parameters</h2>
<p>To have a full lost of devices and check their parameters follow the instruction at the page <a class="el" href="yarpdev.html">yarpdev: the standard YARP device utility</a></p>
<p>More advanced topics: true nesting of device properties; calibration objects. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li><span id="projectname_footer">YARP</span></li>
    <li><span id="projectnumber" class="version_switch">3.6.0</span></li>
    <li class="footer">Generated on Wed Jun 1 2022 14:48:31 for YARP by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
