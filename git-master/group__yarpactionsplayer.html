<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>YARP: yarpactionsplayer: an utility to replay robot movements</title>
<link rel="shortcut icon" href="yarp-favicon.ico" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">
    var DOCUMENTATION_OPTIONS = { VERSION: '3.12.0+40-20250712.10+git0586a7ab8' };
</script>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="yarp-doxygen-style.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../version_switch.js"></script>
<script src="https://cookiehub.net/c2/44d56061.js"></script>
<script type="text/javascript">
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('consent', 'default', {'ad_storage': 'denied', 'analytics_storage': 'denied', 'wait_for_update': 500});
document.addEventListener("DOMContentLoaded", function(event) {
var cpm = {};
window.cookiehub.load(cpm);
});
</script>
<!--
<link rel="stylesheet" type="text/css" href="cookieconsent.min.css" />
<script src="cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#eb6c44",
      "text": "#ffffff"
    },
    "button": {
      "background": "#237afc",
    }
  },
  "theme": "classic",
  "content": {
    "message": "INFORMATION NOTICE ON COOKIES : This website uses only browsing/session cookies. Users can choose whether or not to accept the use of cookies and access the website. By clicking on \"Further information\", the full information notice on the types of cookies will be displayed and you will be able  to choose whether or not to accept them whilst browsing on the website.",
    "dismiss": "ACCEPT and close",
    "link": "Further information",
    "href": "http://www.icub.eu/other/personal_data_notice.html"
  }
})});
</script>
-->
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="yarp-robot-64.png"/></td>
  <td id="projectalign" style="padding-left: 1.5em;">
   <div id="projectname">YARP</div>
   <div id="projectbrief">Yet Another Robot Platform</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__yarpactionsplayer.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">yarpactionsplayer: an utility to replay robot movements<div class="ingroups"><a class="el" href="group__yarp__commands.html">Yarp tools</a></div></div></div>
</div><!--header-->
<div class="contents">
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Collaboration diagram for yarpactionsplayer: an utility to replay robot movements:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__yarpactionsplayer.png" border="0" usemap="#agroup____yarpactionsplayer" alt=""/></div>
<map name="agroup____yarpactionsplayer" id="agroup____yarpactionsplayer">
<area shape="rect" href="group__yarp__commands.html" title="This page includes all command line executables." alt="" coords="5,20,91,45"/>
<area shape="rect" title=" " alt="" coords="139,5,285,60"/>
</map>
</div>
<h1><a class="anchor" id="autotoc_md9"></a>
yarpActionsPlayer</h1>
<p><code>yarpActionsPlayer</code> is an executable designed to control a robot (real or simulated) by sending timestamped position commands to its joints, enabling it to replicate specified trajectories.</p>
<h2><a class="anchor" id="autotoc_md10"></a>
Startup</h2>
<p>At the startup, the executable receives in input a set of files, each of them describing a trajectory for one or more joints. Each trajectory is called <code>action</code> and is identified by a name. The trajectory files have the following format:</p><ul>
<li>The first column is a progressive counter (not used)</li>
<li>The second column is a timestamp (in seconds)</li>
<li>All subsequent columns are position values, one joint for each column.</li>
</ul>
<p>Here is an example of a trajectory file for two joints, with positions sampled at a period of 10ms: </p><div class="fragment"><div class="line">0    0.010   0.000   0.000</div>
<div class="line">1    0.020   1.253   1.253</div>
<div class="line">2    0.030   2.487   2.487</div>
<div class="line">3    0.040   3.681   3.681</div>
<div class="line">4    0.050   4.818   4.818</div>
<div class="line">5    0.060   5.878   5.878</div>
<div class="line">6    0.070   6.845   6.845</div>
<div class="line">7    0.080   7.705   7.705</div>
<div class="line">8    0.090   8.443   8.443</div>
<div class="line">9    0.090   9.048   9.048</div>
<div class="line">10   0.100   9.511   9.511</div>
<div class="line">11   0.110   9.823   9.823</div>
<div class="line">12   0.120   9.980   9.980</div>
</div><!-- fragment --><p> This format is consistent with the output of the state port of a <code>controlBoard_nws_yarp</code>. The following command can be used to record the trajectory of a moving robot and obtain a trajectory file that can reproduced with <code>yarpActionsPlayer</code>. </p><div class="fragment"><div class="line">yarp read ... /robot/part/state:o envelope &gt; file.txt</div>
</div><!-- fragment --><p> The joints commands are assigned to the robot by using a <code>remoteControlBoardremapper</code> device. In this way, the user can select to work with joints also belonging to different parts of the robot and synchronize the movements between them. The following file, configuration.ini (see the <code>example</code> folder) creates two different controllers, <code>controller1</code> and <code>controller2</code>. The first one will control the joints called <code>hjoint1</code> and <code>hjoint2</code> of the robot part <code>/robot/head</code>. The second one will attach to two different parts of the robot, i.e. <code>/robot/head</code> <code>/robot/arm</code> and control the joints<code>hjoint1</code>,<code>ajoint1</code>,<code>ajoint3</code> which belong to these parts. Please note that the number of joints described in the controller (and their order) must match the number of joints indicated in the trajectory file. As shown in the following example, user has to associate a controller for each action file to correctly map the trajectories described in the file with the joints to actuate. </p><div class="fragment"><div class="line">[CONTROLLERS]</div>
<div class="line">controller1 (/robot/head) (hjoint1 hjoint2)</div>
<div class="line">controller2 (/robot/head /robot/arm) (hjoint1 ajoint1 ajoint3)</div>
<div class="line"> </div>
<div class="line">[ACTIONS]</div>
<div class="line">wave_hand        controller1   trajectory_file1.txt</div>
<div class="line">rise_hand        controller1   trajectory_file2.txt</div>
<div class="line">turn_head_left   controller2   trajectory_file3.txt</div>
<div class="line">turn_head_right  controller2   trajectory_file4.txt</div>
</div><!-- fragment --> <h2><a class="anchor" id="autotoc_md11"></a>
Basic usage</h2>
<p>After starting <code>yarpActionsPlayer</code> by providing the above mentioned configuration files, the module will wait to received user commands via rpc port, e.g. <code>/yarpActionsPlayer/rpc</code> Use the <code>help</code> command to list all possible commands. The command <code>show_actions</code> will display the names of the actions loaded at startup. The command <code>play &lt;action_name&gt;</code> will play an action once. The command <code>choose &lt;action_name&gt;</code> will allow to select an action to perform more advanced commands, such as changing its playback speed, pausing it during execution or setting it to loop continuously.</p>
<h2><a class="anchor" id="autotoc_md12"></a>
Advanced considerations / Parameters tuning</h2>
<p><code>yarpActionsPlayer</code> uses a periodic thread to schedule the execution of the commanded position at the correct time. The option <code>--period</code> allows to set the period of this thread: small values allows to schedule the command with more accuracy. The suggested value is 0.005 seconds.</p>
<p>Another important parameter to consider is the trajectory sampling period. By default, the application does not internally resample loaded trajectories, allowing files with variable sampling rates to be used. However, users may choose to resample a trajectory to a specific rate using the <code>--resample</code> option. When this option is enabled, all trajectories are resampled at the specified frequency using linear interpolation. This feature can help compensate for nonlinearities in the joint position controllerâ€™s response and reduce vibrations caused by overshoots (*) It is generally recommended to keep this sampling period small, in the 0.005 - 0.0010 seconds range to avoid overshoots of the controller when performing a direct position control of the joint. Small values will also guarantee that the difference in position between two subsequent frames is small.</p>
<p>(*) The response of the controller for the following two set of trajectories is generally different, event if the final position is reached in the same amount of time: </p><div class="fragment"><div class="line">q2(t2=0.1)  = 1</div>
<div class="line">q1(t1=0.0)  = 0</div>
</div><!-- fragment --> <div class="fragment"><div class="line">q5(t5=0.1)   = 1</div>
<div class="line">q4(t4=0.75)  = 0.75</div>
<div class="line">q3(t3=0.5)   = 0.5</div>
<div class="line">q2(t2=0.025) = 0.25</div>
<div class="line">q1(t1=0.0)   = 0</div>
</div><!-- fragment --><p> In the first case, a large movement (1 degree) might cause overshoot, while in the second case, the phenomena is mitigated by keeping limited the reference delta to a small value.</p>
<h2><a class="anchor" id="autotoc_md13"></a>
Joints initial position and robot safety</h2>
<p>yarpActionsPlayer controls the robot using <code>positionDirect</code> control mode (see <a href="https://www.yarp.it/latest/classyarp_1_1dev_1_1IPositionDirect.html">https://www.yarp.it/latest/classyarp_1_1dev_1_1IPositionDirect.html</a>). In this mode, the target is provided as a step reference and the joints are commanded to reach the final position with no limitations in the the movement speed. This control mode is thus intrinsically unsafe, especially if the difference between the current and the commanded position is large. For this reason a number of safety checks are included in the control module.</p><ul>
<li>When the action is tarted, the robot will start to move in position mode (and not in position direct mode) to the first reference using a limited speed.</li>
<li>Before starting the action playback, the module will check that the first reference is reached within a specified tolerance, which can be defined by the option <code>pos_tolerance</code> (default value: 2 degrees).</li>
<li>If the option <code>pos_strict_check</code> is enabled (default value: false) the system will halt if the tolerance threshold is not reached, otherwise it will continue with normal operation afterwards, switching to position direct mode. The timeout is defined by the parameter <code>pos_timeout</code> (default value: 2seconds)</li>
<li>By the default, launching the module will NOT control the robot, it will just simulate it. The user can enable the real control, after checking the correctness of the trajectories on a simulator, using the option <code>execute</code>.</li>
</ul>
<h2><a class="anchor" id="autotoc_md14"></a>
Examples</h2>
<p>The <code>example</code> folder contains the <code>configuration.ini</code> and some test trajectories for a fake robot. To try the the example, you must instantiate a fakerobot using the following commands: </p><div class="fragment"><div class="line">yarpdev --device deviceBundler --wrapper_device controlBoard_nws_yarp --attached_device fakeMotionControl --name /robot/head   --GENERAL::Joints 3  --GENERAL::AxisName &quot;(hjoint1 hjoint2 hjoint3)&quot;</div>
<div class="line">yarpdev --device deviceBundler --wrapper_device controlBoard_nws_yarp --attached_device fakeMotionControl --name /robot/arm    --GENERAL::Joints 6  --GENERAL::AxisName &quot;(ajoint1 ajoint2 ajoint3 ajoint4 ajoint5 ajoint6)&quot;</div>
</div><!-- fragment --><p> You can then observe the movement of the joints using <code>yarpmotorgui</code> or <code>yarpscope</code> executables. </p>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li><span id="projectname_footer">YARP</span></li>
    <li><span id="projectnumber" class="version_switch">3.12.0+40-20250712.10+git0586a7ab8</span></li>
    <li class="footer">Generated on Sat Jul 12 2025 02:48:59 for YARP by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
