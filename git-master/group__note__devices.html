<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>YARP: Getting Started with YARP Devices</title>
<link rel="shortcut icon" href="yarp-favicon.ico" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">
    var DOCUMENTATION_OPTIONS = { VERSION: '3.12.0+40-20250712.10+git0586a7ab8' };
</script>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="yarp-doxygen-style.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../version_switch.js"></script>
<script src="https://cookiehub.net/c2/44d56061.js"></script>
<script type="text/javascript">
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('consent', 'default', {'ad_storage': 'denied', 'analytics_storage': 'denied', 'wait_for_update': 500});
document.addEventListener("DOMContentLoaded", function(event) {
var cpm = {};
window.cookiehub.load(cpm);
});
</script>
<!--
<link rel="stylesheet" type="text/css" href="cookieconsent.min.css" />
<script src="cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#eb6c44",
      "text": "#ffffff"
    },
    "button": {
      "background": "#237afc",
    }
  },
  "theme": "classic",
  "content": {
    "message": "INFORMATION NOTICE ON COOKIES : This website uses only browsing/session cookies. Users can choose whether or not to accept the use of cookies and access the website. By clicking on \"Further information\", the full information notice on the types of cookies will be displayed and you will be able  to choose whether or not to accept them whilst browsing on the website.",
    "dismiss": "ACCEPT and close",
    "link": "Further information",
    "href": "http://www.icub.eu/other/personal_data_notice.html"
  }
})});
</script>
-->
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="yarp-robot-64.png"/></td>
  <td id="projectalign" style="padding-left: 1.5em;">
   <div id="projectname">YARP</div>
   <div id="projectbrief">Yet Another Robot Platform</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__note__devices.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">Getting Started with YARP Devices<div class="ingroups"><a class="el" href="group__dev__all.html">Devices</a> &raquo; <a class="el" href="group__dev__tutorials.html">Tutorials and Examples about Devices</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>For robotics, we need access to all sorts of strange devices.  
</p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Collaboration diagram for Getting Started with YARP Devices:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__note__devices.png" border="0" usemap="#agroup____note____devices" alt=""/></div>
<map name="agroup____note____devices" id="agroup____note____devices">
<area shape="rect" href="group__dev__tutorials.html" title="Tutorials and Examples about Devices." alt="" coords="5,5,179,45"/>
<area shape="rect" title="For robotics, we need access to all sorts of strange devices." alt="" coords="227,5,380,45"/>
</map>
</div>
<p>For robotics, we need access to all sorts of strange devices. </p>
<p>This section contains a tutorial on the YARP view of what devices are. If you just want to get coding immediately, see the <a class="el" href="group__dev__all.html">main page for YARP Devices</a>, including information on interfaces, implementation, configuration and <a class="el" href="">commandline</a> usage.</p>
<h1><a class="anchor" id="note_devices_yarp"></a>
YARP Devices</h1>
<p>There are three separate concerns related to devices in YARP:</p>
<ul>
<li>Implementing specific drivers for particular devices </li>
<li>Defining interfaces for device families </li>
<li>Implementing network wrappers for interfaces</li>
</ul>
<p>The first step, creating drivers for particular devices, is obvious; every robotics project needs to interface with hardware somehow.</p>
<p>The second step, defining interfaces for families of devices, is important in the longer term. If you change your camera or your motor control board, how much of your code needs to change too? If you view your devices through well thought out interfaces, the impact of device change can be minimized.</p>
<p>The third step, network wrappers, is important to give flexibility. You can scale up your computing cluster, or isolate hardware devices that don't play well together, or have specific OS dependencies etc.</p>
<p>A driver in YARP is just a C++ class. Interfaces are simply abstract base classes. And network wrappers are just special cases of devices that happen to use network resources to satisfy their interfaces. Let's look at some examples to make this clear.</p>
<h1><a class="anchor" id="note_devices_example"></a>
Framegrabber interfaces</h1>
<p>We call devices that produce a stream of images <code>framegrabbers</code> for historical reasons. There are a number of interfaces associated with framegrabbers. Here's one, IFrameGrabberImage:</p>
<div class="fragment"><div class="line"><span class="keyword">class </span><a class="code hl_class" href="classyarp_1_1dev_1_1IFrameGrabberOf.html">yarp::dev::IFrameGrabberImage</a> {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> getImage(<a class="code hl_class" href="classyarp_1_1sig_1_1ImageOf.html">yarp::sig::ImageOf&lt;yarp::sig::PixelRgb&gt;</a>&amp; <a class="code hl_enumvalue" href="commands_2yarpdatadumper_2main_8cpp.html#af261caa616a330969044eb9dde645acea78805a221a988e79ef3f42d7c5bfd418">image</a>) = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">int</span> height() <span class="keyword">const</span> = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">int</span> width() <span class="keyword">const</span> = 0;</div>
<div class="line">};</div>
<div class="ttc" id="aclassyarp_1_1dev_1_1IFrameGrabberOf_html"><div class="ttname"><a href="classyarp_1_1dev_1_1IFrameGrabberOf.html">yarp::dev::IFrameGrabberOf&lt; yarp::sig::ImageOf&lt; yarp::sig::PixelRgb &gt; &gt;</a></div></div>
<div class="ttc" id="aclassyarp_1_1sig_1_1ImageOf_html"><div class="ttname"><a href="classyarp_1_1sig_1_1ImageOf.html">yarp::sig::ImageOf</a></div><div class="ttdoc">Typed image class.</div><div class="ttdef"><b>Definition</b> <a href="Image_8h_source.html#l00602">Image.h:603</a></div></div>
<div class="ttc" id="acommands_2yarpdatadumper_2main_8cpp_html_af261caa616a330969044eb9dde645acea78805a221a988e79ef3f42d7c5bfd418"><div class="ttname"><a href="commands_2yarpdatadumper_2main_8cpp.html#af261caa616a330969044eb9dde645acea78805a221a988e79ef3f42d7c5bfd418">DumpFormat::image</a></div><div class="ttdeci">@ image</div></div>
</div><!-- fragment --><p>Notice that <code>IFrameGrabberImage</code> doesn't do anything itself &ndash; it just declares methods to get an image and image dimensions. There are several classes in YARP that implement this interface (in other words, they inherit from it and define the methods). One example is openCVGrabber.</p>
<h1><a class="anchor" id="note_devices_example2"></a>
Writing a Device</h1>
<p>Since you may not have any hardware devices available to you right now, let's make a "fake" framegrabber that implements the <code>IFrameGrabberImage</code> interface:</p>
<div class="fragment"><div class="line"><span class="keyword">class </span><a class="code hl_class" href="classFakeFrameGrabber.html">FakeFrameGrabber</a> : <span class="keyword">public</span> IFrameGrabberImage {</div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    <span class="keywordtype">int</span> w, <span class="keywordtype">int</span> h;</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <a class="code hl_function" href="classFakeFrameGrabber.html#a8ff267cce8e2ae58c670b19a4821ad85">FakeFrameGrabber</a>(<span class="keywordtype">int</span> w, <span class="keywordtype">int</span> h) : w(w), h(h) {</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code hl_function" href="classFakeFrameGrabber.html#ae277aa487717c7c4eed0f3151dc45fca">getImage</a>(<a class="code hl_class" href="classyarp_1_1sig_1_1ImageOf.html">yarp::sig::ImageOf&lt;yarp::sig::PixelRgb&gt;</a>&amp; <a class="code hl_enumvalue" href="commands_2yarpdatadumper_2main_8cpp.html#af261caa616a330969044eb9dde645acea78805a221a988e79ef3f42d7c5bfd418">image</a>) {</div>
<div class="line">    Time::delay(0.5);  <span class="comment">// simulate waiting for hardware to report</span></div>
<div class="line">    <a class="code hl_enumvalue" href="commands_2yarpdatadumper_2main_8cpp.html#af261caa616a330969044eb9dde645acea78805a221a988e79ef3f42d7c5bfd418">image</a>.resize(w,h);</div>
<div class="line">    <a class="code hl_enumvalue" href="commands_2yarpdatadumper_2main_8cpp.html#af261caa616a330969044eb9dde645acea78805a221a988e79ef3f42d7c5bfd418">image</a>.zero();</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code hl_function" href="classFakeFrameGrabber.html#a50a1bf7ffd94c8d59c186a348530fa30">height</a>()<span class="keyword"> const </span>{</div>
<div class="line">    <span class="keywordflow">return</span> h;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code hl_function" href="classFakeFrameGrabber.html#a04553de065a77b39ec3c82ca30708ae7">width</a>()<span class="keyword"> const </span>{</div>
<div class="line">    <span class="keywordflow">return</span> w;</div>
<div class="line">    }</div>
<div class="line">};</div>
<div class="ttc" id="aclassFakeFrameGrabber_html"><div class="ttname"><a href="classFakeFrameGrabber.html">FakeFrameGrabber</a></div><div class="ttdoc">fakeFrameGrabber: A fake camera for testing.</div><div class="ttdef"><b>Definition</b> <a href="FakeFrameGrabber_8h_source.html#l00040">FakeFrameGrabber.h:55</a></div></div>
<div class="ttc" id="aclassFakeFrameGrabber_html_a04553de065a77b39ec3c82ca30708ae7"><div class="ttname"><a href="classFakeFrameGrabber.html#a04553de065a77b39ec3c82ca30708ae7">FakeFrameGrabber::width</a></div><div class="ttdeci">int width() const override</div><div class="ttdoc">Return the width of each frame.</div><div class="ttdef"><b>Definition</b> <a href="FakeFrameGrabber_8cpp_source.html#l00331">FakeFrameGrabber.cpp:331</a></div></div>
<div class="ttc" id="aclassFakeFrameGrabber_html_a50a1bf7ffd94c8d59c186a348530fa30"><div class="ttname"><a href="classFakeFrameGrabber.html#a50a1bf7ffd94c8d59c186a348530fa30">FakeFrameGrabber::height</a></div><div class="ttdeci">int height() const override</div><div class="ttdoc">Return the height of each frame.</div><div class="ttdef"><b>Definition</b> <a href="FakeFrameGrabber_8cpp_source.html#l00327">FakeFrameGrabber.cpp:327</a></div></div>
<div class="ttc" id="aclassFakeFrameGrabber_html_a8ff267cce8e2ae58c670b19a4821ad85"><div class="ttname"><a href="classFakeFrameGrabber.html#a8ff267cce8e2ae58c670b19a4821ad85">FakeFrameGrabber::FakeFrameGrabber</a></div><div class="ttdeci">FakeFrameGrabber()=default</div></div>
<div class="ttc" id="aclassFakeFrameGrabber_html_ae277aa487717c7c4eed0f3151dc45fca"><div class="ttname"><a href="classFakeFrameGrabber.html#ae277aa487717c7c4eed0f3151dc45fca">FakeFrameGrabber::getImage</a></div><div class="ttdeci">bool getImage(yarp::sig::ImageOf&lt; yarp::sig::PixelRgb &gt; &amp;image) override</div><div class="ttdoc">Get an image from the frame grabber.</div><div class="ttdef"><b>Definition</b> <a href="FakeFrameGrabber_8cpp_source.html#l00431">FakeFrameGrabber.cpp:431</a></div></div>
</div><!-- fragment --><p>All this does is return blank images roughly every half second, but it does indeed implement the <code>IFrameGrabberImage</code> interface.</p>
<p>We very nearly have a YARP device driver. Sometimes we want to be able to create devices flexibly, based on a configuration file, or without having to worry about where their header file is. For these purposes, YARP requires that: </p><ul>
<li>All device drivers inherit from the "DeviceDriver" class. </li>
<li>All device drivers implement an <em>open</em> and <em>close</em> method. </li>
<li>Device drivers should be using no hardware resources before open is called or after close is called. YARP in return will promise that <em>open</em> will be the first method called after construction, and that if open returns false no other methods will be called before destruction. The <em>open</em> method takes a configuration object which can contain arbitrary properties.</li>
</ul>
<p>This is quite straightforward to do for our fake framegrabber:</p>
<div class="fragment"><div class="line"><span class="keyword">class </span><a class="code hl_class" href="classFakeFrameGrabber.html">FakeFrameGrabber</a> : <span class="keyword">public</span> IFrameGrabberImage,</div>
<div class="line">             <span class="keyword">public</span> <a class="code hl_class" href="classyarp_1_1dev_1_1DeviceDriver.html">yarp::dev::DeviceDriver</a> {</div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    <span class="keywordtype">int</span> w, <span class="keywordtype">int</span> h;</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <a class="code hl_function" href="classFakeFrameGrabber.html#a8ff267cce8e2ae58c670b19a4821ad85">FakeFrameGrabber</a>() {</div>
<div class="line">    h = w = 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">bool</span> <a class="code hl_function" href="classFakeFrameGrabber.html#a9ddf08b24b0ae18c4e8e6a902d5328cb">open</a>(<span class="keywordtype">int</span> w, <span class="keywordtype">int</span> h) {</div>
<div class="line">    this-&gt;w = w;</div>
<div class="line">    this-&gt;h = h;</div>
<div class="line">    <span class="keywordflow">return</span> w&gt;0 &amp;&amp; h&gt;0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code hl_function" href="classFakeFrameGrabber.html#a9ddf08b24b0ae18c4e8e6a902d5328cb">open</a>(<a class="code hl_class" href="classyarp_1_1os_1_1Searchable.html">yarp::os::Searchable</a>&amp; config) {</div>
<div class="line">    <span class="comment">// extract width and height configuration, if present</span></div>
<div class="line">    <span class="comment">// otherwise use 128x128</span></div>
<div class="line">    <span class="keywordtype">int</span> desiredWidth = config.<a class="code hl_function" href="classyarp_1_1os_1_1Searchable.html#aa7b406215b653817f2450ac416b65867">check</a>(<span class="stringliteral">&quot;w&quot;</span>,Value(128)).asInt32();</div>
<div class="line">    <span class="keywordtype">int</span> desiredHeight = config.<a class="code hl_function" href="classyarp_1_1os_1_1Searchable.html#aa7b406215b653817f2450ac416b65867">check</a>(<span class="stringliteral">&quot;h&quot;</span>,Value(128)).asInt32();</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_function" href="classFakeFrameGrabber.html#a9ddf08b24b0ae18c4e8e6a902d5328cb">open</a>(desiredWidth,desiredHeight);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code hl_function" href="classFakeFrameGrabber.html#aff4ecdb37f6a383fcd66c586e67cbc24">close</a>() {</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>; <span class="comment">// easy</span></div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code hl_function" href="classFakeFrameGrabber.html#ae277aa487717c7c4eed0f3151dc45fca">getImage</a>(<a class="code hl_class" href="classyarp_1_1sig_1_1ImageOf.html">yarp::sig::ImageOf&lt;yarp::sig::PixelRgb&gt;</a>&amp; <a class="code hl_enumvalue" href="commands_2yarpdatadumper_2main_8cpp.html#af261caa616a330969044eb9dde645acea78805a221a988e79ef3f42d7c5bfd418">image</a>) {</div>
<div class="line">    Time::delay(0.5);  <span class="comment">// simulate waiting for hardware to report</span></div>
<div class="line">    <a class="code hl_enumvalue" href="commands_2yarpdatadumper_2main_8cpp.html#af261caa616a330969044eb9dde645acea78805a221a988e79ef3f42d7c5bfd418">image</a>.resize(w,h);</div>
<div class="line">    <a class="code hl_enumvalue" href="commands_2yarpdatadumper_2main_8cpp.html#af261caa616a330969044eb9dde645acea78805a221a988e79ef3f42d7c5bfd418">image</a>.zero();</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code hl_function" href="classFakeFrameGrabber.html#a50a1bf7ffd94c8d59c186a348530fa30">height</a>()<span class="keyword"> const </span>{</div>
<div class="line">    <span class="keywordflow">return</span> h;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code hl_function" href="classFakeFrameGrabber.html#a04553de065a77b39ec3c82ca30708ae7">width</a>()<span class="keyword"> const </span>{</div>
<div class="line">    <span class="keywordflow">return</span> w;</div>
<div class="line">    }</div>
<div class="line">};</div>
<div class="ttc" id="aclassFakeFrameGrabber_html_a9ddf08b24b0ae18c4e8e6a902d5328cb"><div class="ttname"><a href="classFakeFrameGrabber.html#a9ddf08b24b0ae18c4e8e6a902d5328cb">FakeFrameGrabber::open</a></div><div class="ttdeci">bool open(yarp::os::Searchable &amp;config) override</div><div class="ttdef"><b>Definition</b> <a href="FakeFrameGrabber_8cpp_source.html#l00202">FakeFrameGrabber.cpp:202</a></div></div>
<div class="ttc" id="aclassFakeFrameGrabber_html_aff4ecdb37f6a383fcd66c586e67cbc24"><div class="ttname"><a href="classFakeFrameGrabber.html#aff4ecdb37f6a383fcd66c586e67cbc24">FakeFrameGrabber::close</a></div><div class="ttdeci">bool close() override</div><div class="ttdoc">Close the DeviceDriver.</div><div class="ttdef"><b>Definition</b> <a href="FakeFrameGrabber_8cpp_source.html#l00196">FakeFrameGrabber.cpp:196</a></div></div>
<div class="ttc" id="aclassyarp_1_1dev_1_1DeviceDriver_html"><div class="ttname"><a href="classyarp_1_1dev_1_1DeviceDriver.html">yarp::dev::DeviceDriver</a></div><div class="ttdoc">Interface implemented by all device drivers.</div><div class="ttdef"><b>Definition</b> <a href="DeviceDriver_8h_source.html#l00028">DeviceDriver.h:29</a></div></div>
<div class="ttc" id="aclassyarp_1_1os_1_1Searchable_html"><div class="ttname"><a href="classyarp_1_1os_1_1Searchable.html">yarp::os::Searchable</a></div><div class="ttdoc">A base class for nested structures that can be searched.</div><div class="ttdef"><b>Definition</b> <a href="Searchable_8h_source.html#l00030">Searchable.h:31</a></div></div>
<div class="ttc" id="aclassyarp_1_1os_1_1Searchable_html_aa7b406215b653817f2450ac416b65867"><div class="ttname"><a href="classyarp_1_1os_1_1Searchable.html#aa7b406215b653817f2450ac416b65867">yarp::os::Searchable::check</a></div><div class="ttdeci">virtual bool check(const std::string &amp;key) const =0</div><div class="ttdoc">Check if there exists a property of the given name.</div></div>
</div><!-- fragment --><p>Now we have a good YARP device driver (even if it is fake). We've chosen to require that the width and height of images be greater than zero, which seems reasonable.</p>
<h1><a class="anchor" id="note_devices_library"></a>
Direct instantiation of a device</h1>
<p>We can create, configure, and use our device directly, without any bureaucracy: </p><div class="fragment"><div class="line"><a class="code hl_class" href="classFakeFrameGrabber.html">FakeFrameGrabber</a> fakey;</div>
<div class="line">fakey.<a class="code hl_function" href="classFakeFrameGrabber.html#a9ddf08b24b0ae18c4e8e6a902d5328cb">open</a>(640,480);</div>
<div class="line">ImageOf&lt;PixelRgb&gt; img;</div>
<div class="line">fakey.<a class="code hl_function" href="classFakeFrameGrabber.html#ae277aa487717c7c4eed0f3151dc45fca">getImage</a>(img);</div>
<div class="line">...</div>
<div class="line">fakey.close();</div>
</div><!-- fragment --><p>If we're smart, we'd make as much of our code as possible depend just on the interface IFrameGrabberImage, so that we can reuse it or substitute in a different framegrabber later: </p><div class="fragment"><div class="line"><span class="comment">// creation and configuration -- depends on specific device type</span></div>
<div class="line"><a class="code hl_class" href="classFakeFrameGrabber.html">FakeFrameGrabber</a> fakey;</div>
<div class="line">fakey.<a class="code hl_function" href="classFakeFrameGrabber.html#a9ddf08b24b0ae18c4e8e6a902d5328cb">open</a>(640,480);</div>
<div class="line">IFrameGrabberImage&amp; genericGrabber = fakey;</div>
<div class="line"><span class="comment">// from here on, we only care that our device implements IFrameGrabberImage</span></div>
<div class="line">ImageOf&lt;PixelRgb&gt; img;</div>
<div class="line">genericGrabber.<a class="code hl_function" href="classFakeFrameGrabber.html#ae277aa487717c7c4eed0f3151dc45fca">getImage</a>(img);</div>
<div class="line">...</div>
<div class="line">fakey.close();</div>
</div><!-- fragment --><p> This is a standard software engineering technique for minimizing unnecessary coupling between modules.</p>
<h1><a class="anchor" id="note_devices_library2"></a>
Instantiation of a registered device</h1>
<p>Suppose we want to go further, and let the framegrabber we use be controlled by a command line option. So it could either be our <a class="el" href="classFakeFrameGrabber.html" title="fakeFrameGrabber: A fake camera for testing.">FakeFrameGrabber</a>, or a real device like <code>DragonflyFrameGrabber</code> or <code>OpenCVFrameGrabber</code>, etc.</p>
<p>YARP comes with a helper for doing this. It maintains a simple database of the drivers you have compiled and available. You can see this database by running "yarpdev", which tells you something like: </p><pre class="fragment">...
Here are devices listed for your system:

Device &lt;dragonfly&gt;
   documented by the C++ class DragonflyDeviceDriver
   Wrapped for the network by &lt;frameGrabber_nws_yarp&gt;

Device &lt;fakeFrameGrabber&gt;
   documented by the C++ class FakeFrameGrabber
   Wrapped for the network by &lt;frameGrabber_nws_yarp&gt;

Device &lt;openCVGrabber&gt;
   documented by the C++ class OpenCVGrabber
   Wrapped for the network by &lt;frameGrabber_nws_yarp&gt;
...
</pre><p> We see a <code>dragonfly</code> listing associated with the <code>DragonflyDeviceDriver</code> class &ndash; "dragonfly" is this devices <em>common name</em> to which it is referred to in configuration files, command line options, etc.. There is also a <code>fakeFrameGrabber</code> listing associated with a <code><a class="el" href="classFakeFrameGrabber.html" title="fakeFrameGrabber: A fake camera for testing.">FakeFrameGrabber</a></code> class &ndash; this is in fact a more elaborate version of the fake framegrabber we've been working on, for testing purposes. We can ignore it for now.</p>
<p>You can instantiate any device listed here from your code as follows: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="PolyDriver_8h.html">yarp/dev/PolyDriver.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="IFrameGrabberImage_8h.html">yarp/dev/IFrameGrabberImage.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Image_8h.html">yarp/sig/Image.h</a>&gt;</span></div>
<div class="line"><span class="keyword">using </span><a class="code hl_class" href="classyarp_1_1dev_1_1PolyDriver.html">yarp::dev::PolyDriver</a>;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_class" href="classyarp_1_1dev_1_1IFrameGrabberOf.html">yarp::dev::IFrameGrabberImage</a>;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_class" href="classyarp_1_1sig_1_1ImageOf.html">yarp::sig::ImageOf</a>;</div>
<div class="line"><span class="keyword">using </span>yarp::sig::PixelRgb;</div>
<div class="line">...</div>
<div class="line">PolyDriver dd(<span class="stringliteral">&quot;dragonfly&quot;</span>);</div>
<div class="line"><span class="keywordflow">if</span> (!dd.isValid()) {</div>
<div class="line">  printf(<span class="stringliteral">&quot;Dragonfly not available\n&quot;</span>);</div>
<div class="line">  exit(1);</div>
<div class="line">}</div>
<div class="line">IFrameGrabberImage *grabber;</div>
<div class="line">dd.view(grabber);</div>
<div class="line"><span class="keywordflow">if</span> (grabber!=NULL) {</div>
<div class="line">  printf(<span class="stringliteral">&quot;*** Device can supply images\n&quot;</span>);</div>
<div class="line">  ImageOf&lt;PixelRgb&gt; img;</div>
<div class="line">  <span class="keywordflow">if</span> (grabber-&gt;getImage(img)) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;*** Got a %zux%zu image\n&quot;</span>, img.width(), img.height());</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="ttc" id="aIFrameGrabberImage_8h_html"><div class="ttname"><a href="IFrameGrabberImage_8h.html">IFrameGrabberImage.h</a></div></div>
<div class="ttc" id="aImage_8h_html"><div class="ttname"><a href="Image_8h.html">Image.h</a></div></div>
<div class="ttc" id="aPolyDriver_8h_html"><div class="ttname"><a href="PolyDriver_8h.html">PolyDriver.h</a></div></div>
<div class="ttc" id="aclassyarp_1_1dev_1_1PolyDriver_html"><div class="ttname"><a href="classyarp_1_1dev_1_1PolyDriver.html">yarp::dev::PolyDriver</a></div><div class="ttdoc">A container for a device driver.</div><div class="ttdef"><b>Definition</b> <a href="PolyDriver_8h_source.html#l00021">PolyDriver.h:23</a></div></div>
</div><!-- fragment --><p> Just replace the name "dragonfly" with the device you want.</p>
<h1><a class="anchor" id="note_devices_library3"></a>
Registering a new device to the database</h1>
<p>If we want to be able to create a <a class="el" href="classFakeFrameGrabber.html" title="fakeFrameGrabber: A fake camera for testing.">FakeFrameGrabber</a> through the same mechanism, we need to add a <em>factory</em> for it to the device driver database. Here's how: </p><div class="fragment"><div class="line">DriverCreator *fakey_factory =</div>
<div class="line">   <span class="keyword">new</span> DriverCreatorOf&lt;FakeFrameGrabber&gt;(<span class="stringliteral">&quot;fakey&quot;</span>,<span class="stringliteral">&quot;grabber&quot;</span>,<span class="stringliteral">&quot;FakeFrameGrabber&quot;</span>);</div>
<div class="line">Drivers::factory().add(fakey_factory); <span class="comment">// hand factory over to YARP</span></div>
</div><!-- fragment --><p> The name "fakey" is an arbitrary common name we pick. The name "grabber" gives a network wrapper for this device ("" if there is none). The class name "FakeFrameGrabber" is recorded to let the user know where to look for documentation on this device.</p>
<p>Now we can do: </p><div class="fragment"><div class="line">PolyDriver dd(<span class="stringliteral">&quot;fakey&quot;</span>);</div>
<div class="line">IFrameGrabberImage *grabber;</div>
<div class="line">dd.view(grabber);</div>
<div class="line"><span class="keywordflow">if</span> (grabber == <span class="keyword">nullptr</span>) { exit(1); } <span class="comment">// failed</span></div>
<div class="line"><span class="comment">// from here on, we only care that our device implements IFrameGrabberImage</span></div>
<div class="line">ImageOf&lt;PixelRgb&gt; img;</div>
<div class="line">grabber-&gt;getImage(img);</div>
<div class="line">...</div>
</div><!-- fragment --><p>This form is calling <a class="el" href="classFakeFrameGrabber.html#a9ddf08b24b0ae18c4e8e6a902d5328cb">FakeFrameGrabber::open</a> without any configuration information set up. To pass in configuration options, we do: </p><div class="fragment"><div class="line">Property config(<span class="stringliteral">&quot;(device fakey) (w 640) (h 480)&quot;</span>);</div>
<div class="line">PolyDriver dd(config);</div>
<div class="line">...</div>
</div><!-- fragment --><h1><a class="anchor" id="note_devices_library4"></a>
Automatic device registration as Yarp Plugin</h1>
<p>YARP plugins architecture allows an easy way to register a new device in the database, since it automatically generates the code for related to Drivers::factory(). See the page <a class="el" href="group__add__a__plugin.html">Add a plugin to YARP</a>.</p>
<h1><a class="anchor" id="note_devices_library5"></a>
Automatically generated parameters parsers</h1>
<p>As shown in the example, the user parameter parsing is performed inside the open() function. It might become challenging to correctly parse tens of parameters, and to keep updated the documentation. For this reason, an tool, called <code>yarpDeviceParamParserGenerator</code> was developed. The tool takes in input a text file containing a list of parameters and generates the corresponding .cpp and .h files to be included in the project. Details are provided in the <a class="el" href="group__yarpDeviceParamParserGenerator.html">yarpDeviceParamParserGenerator: YARP code generator/compiler for parameters parsers</a> page. </p>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li><span id="projectname_footer">YARP</span></li>
    <li><span id="projectnumber" class="version_switch">3.12.0+40-20250712.10+git0586a7ab8</span></li>
    <li class="footer">Generated on Sat Jul 12 2025 02:48:59 for YARP by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
