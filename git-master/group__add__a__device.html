<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>YARP: CMake tutorial: how to add a device to YARP</title>
<link rel="shortcut icon" href="yarp-favicon.ico" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">
    var DOCUMENTATION_OPTIONS = { VERSION: '3.12.0+40-20250712.10+git0586a7ab8' };
</script>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="yarp-doxygen-style.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../version_switch.js"></script>
<script src="https://cookiehub.net/c2/44d56061.js"></script>
<script type="text/javascript">
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('consent', 'default', {'ad_storage': 'denied', 'analytics_storage': 'denied', 'wait_for_update': 500});
document.addEventListener("DOMContentLoaded", function(event) {
var cpm = {};
window.cookiehub.load(cpm);
});
</script>
<!--
<link rel="stylesheet" type="text/css" href="cookieconsent.min.css" />
<script src="cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#eb6c44",
      "text": "#ffffff"
    },
    "button": {
      "background": "#237afc",
    }
  },
  "theme": "classic",
  "content": {
    "message": "INFORMATION NOTICE ON COOKIES : This website uses only browsing/session cookies. Users can choose whether or not to accept the use of cookies and access the website. By clicking on \"Further information\", the full information notice on the types of cookies will be displayed and you will be able  to choose whether or not to accept them whilst browsing on the website.",
    "dismiss": "ACCEPT and close",
    "link": "Further information",
    "href": "http://www.icub.eu/other/personal_data_notice.html"
  }
})});
</script>
-->
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="yarp-robot-64.png"/></td>
  <td id="projectalign" style="padding-left: 1.5em;">
   <div id="projectname">YARP</div>
   <div id="projectbrief">Yet Another Robot Platform</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__add__a__device.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">CMake tutorial: how to add a device to YARP<div class="ingroups"><a class="el" href="group__dev__all.html">Devices</a> &raquo; <a class="el" href="group__dev__tutorials.html">Tutorials and Examples about Devices</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>In YARP, a device driver is a class that implements one or more <a class="el" href="group__dev__iface.html">interfaces</a>.  
</p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Collaboration diagram for CMake tutorial: how to add a device to YARP:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="group__add__a__device.png" border="0" usemap="#agroup____add____a____device" alt=""/></div>
<map name="agroup____add____a____device" id="agroup____add____a____device">
<area shape="rect" title="In YARP, a device driver is a class that implements one or more interfaces." alt="" coords="227,5,407,45"/>
<area shape="rect" href="group__dev__tutorials.html" title="Tutorials and Examples about Devices." alt="" coords="5,5,179,45"/>
</map>
</div>
<p>In YARP, a device driver is a class that implements one or more <a class="el" href="group__dev__iface.html">interfaces</a>. </p>
<p>If you're interested in learning how to use device drivers, see <a class="el" href="group__note__devices.html">Getting Started with YARP Devices</a>, and <a class="el" href="group__yarpdev.html">yarpdev: the standard YARP device utility</a>. If you're read all that before and are interested in learning how to create devices, then read on...</p>
<h1><a class="anchor" id="dev2-howto-intro"></a>
What is a device driver in YARP?</h1>
<p>A device driver should derive from the abstract class <code><a class="el" href="classyarp_1_1dev_1_1DeviceDriver.html" title="Interface implemented by all device drivers.">yarp::dev::DeviceDriver</a></code>. This interface contains methods common to all device drivers, such as open and close.</p>
<p>Additionally a device driver should implement a selection of other interfaces that capture what it shares with other families of devices. For example a camera might implement <code>yarp::dev::IFrameGrabber</code> (a "raw" interface to the raw data) and/or <code><a class="el" href="namespaceyarp_1_1dev.html#a38f106a310974d842363a9fbc733d136">yarp::dev::IFrameGrabberImage</a></code> (a higher-level source of images). For example, the <code>yarp::dev::DragonflyDeviceDriver</code> class implements a few of these interfaces. Interfaces are abstract classes, the idea is that from outside the user can access a device by using a pointer to the interface he/she needs, if that interface is supported by the device. This is quite similar to the way COM works (in a simplified way).</p>
<p>In practice to implement a new device you create a new class which derives from <code>DeviceDriver</code> and from the interfaces you want to support, and you implement them. The interfaces are documented in the code, using the doxygen standard. See <a class="el" href="group__note__devices.html">Getting Started with YARP Devices</a> for an example.</p>
<h1><a class="anchor" id="dev2-howto-steps"></a>
Step by step instructions</h1>
<p>So you want to add a device to YARP? </p><ul>
<li>Place your device in a subdirectory of <code>$YARP_ROOT/src/devices</code>. This isn't actually a requirement, but it is the easiest way to start. Let us say you pick the directory foo. </li>
<li>Get an example that uses your device compiling with CMake in your directory. </li>
<li>Split your example into a library part, with contains the device code, and an executable, which exercises the device. The library part should include at least one class that inherits from <code><a class="el" href="classyarp_1_1dev_1_1DeviceDriver.html" title="Interface implemented by all device drivers.">yarp::dev::DeviceDriver</a></code>. Let's suppose that class is called <code>FooDriver</code>, and is defined in <code>FooDriver.h</code> </li>
<li>Just to review, your <code>foo/CMakeLists.txt</code> file might look something like this: <div class="fragment"><div class="line">find_package(YARP COMPONENTS os dev REQUIRED)</div>
<div class="line"># ... find and use other needed libraries ...</div>
<div class="line">add_library(foodev)</div>
<div class="line">target_sources(foodev PRIVATE FooDriver.cpp</div>
<div class="line">                              FooDriver.h)</div>
<div class="line">target_link_libraries(foodev PRIVATE YARP::YARP_os</div>
<div class="line">                                     YARP::YARP_dev)</div>
<div class="line"> </div>
<div class="line">add_executable(example)</div>
<div class="line">target_sources(example PRIVATE FooExample.cpp)</div>
<div class="line">target_link_libraries(example PRIVATE foodev)</div>
</div><!-- fragment --> </li>
<li>Got all that working? Good. When your device gets bundled up with others, YARP will define the CMake <code>COMPILE_DEVICE_LIBRARY</code> variable. So please modify your <code>CMakeLists.txt</code> so that if this variable is set, all it does is add your device library, and skips any testing you might do. <div class="fragment"><div class="line">find_package(YARP COMPONENTS os dev REQUIRED)</div>
<div class="line"># ... find and use other needed libraries ...</div>
<div class="line">add_library(foodev)</div>
<div class="line">target_sources foodev PRIVATE FooDriver.cpp</div>
<div class="line">                              FooDriver.h)</div>
<div class="line">target_link_libraries(foodev PRIVATE YARP::YARP_os</div>
<div class="line">                                     YARP::YARP_dev)</div>
<div class="line">if(NOT COMPILE_DEVICE_LIBRARY)</div>
<div class="line">  add_executable(example)</div>
<div class="line">  target_sources(example PRIVATE FooExample.cpp)</div>
<div class="line">  target_link_libraries(example PRIVATE foodev)</div>
<div class="line">endif()</div>
</div><!-- fragment --> </li>
<li>One more thing: YARP needs to keep track of a global list of devices, their names, and other details. To do this, add in some code like this at the very beginning of your <code>CMakeLists.txt</code> <div class="fragment"><div class="line">if(COMPILE_DEVICE_LIBRARY)</div>
<div class="line">  yarp_prepare_plugin(foo</div>
<div class="line">                      TYPE FooDriver</div>
<div class="line">                      INCLUDE FooDriver.h</div>
<div class="line">                      CATEGORY device)</div>
<div class="line">endif()</div>
</div><!-- fragment --> </li>
<li>It is good to add this before searching for any libraries or files, so that you can suppress such searches if the device is not needed by the eventual user. In that case, the <code>SKIP_foo</code> variable will be set, so you can do: <div class="fragment"><div class="line">if(COMPILE_DEVICE_LIBRARY)</div>
<div class="line">  yarp_prepare_plugin(foo</div>
<div class="line">                      TYPE FooDriver</div>
<div class="line">                      INCLUDE FooDriver.h</div>
<div class="line">                      CATEGORY device)</div>
<div class="line">endif()</div>
<div class="line">if(NOT SKIP_foo)</div>
<div class="line">  find_package(YARP COMPONENTS os dev REQUIRED)</div>
<div class="line">  # ... find and use other needed libraries ...</div>
<div class="line">  yarp_add_plugin(foodev)</div>
<div class="line">  target_sources(foodev PRIVATE FooDriver.cpp</div>
<div class="line">                                FooDriver.h)</div>
<div class="line">  target_link_libraries(foodev PRIVATE YARP::YARP_os</div>
<div class="line">                                       YARP::YARP_dev)</div>
<div class="line">  if(NOT COMPILE_DEVICE_LIBRARY)</div>
<div class="line">    add_executable(example)</div>
<div class="line">    target_sources(example PRIVATE FooExample.cpp)</div>
<div class="line">    target_link_libraries(example PRIVATE foodev)</div>
<div class="line">  endif()</div>
<div class="line">endif()</div>
</div><!-- fragment --> </li>
<li>To actually try compiling your device, edit <code>$YARP_ROOT/src/devices/CMakeLists.txt</code> and add in where all the similar lines are: <div class="fragment"><div class="line">add_subdirectory(foo)</div>
</div><!-- fragment --> </li>
<li>(Alternatively, you can copy <code>$YARP_ROOT/src/devices/CMakeLists.txt</code> to some other directory, remove all the other <code>add_subdirectory</code> lines and just leave your own) </li>
<li>Now rebuild the YARP library. You should now be able to configure it to link your device. </li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li><span id="projectname_footer">YARP</span></li>
    <li><span id="projectnumber" class="version_switch">3.12.0+40-20250712.10+git0586a7ab8</span></li>
    <li class="footer">Generated on Sat Jul 12 2025 02:48:59 for YARP by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
